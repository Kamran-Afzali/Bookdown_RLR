<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Function Approximation And Feature Engineering | Reinforcement Learning in R</title>
  <meta name="description" content="Chapter 11 Function Approximation And Feature Engineering | Reinforcement Learning in R" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Function Approximation And Feature Engineering | Reinforcement Learning in R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Function Approximation And Feature Engineering | Reinforcement Learning in R" />
  
  
  

<meta name="author" content="Kamran Afzalui" />


<meta name="date" content="2025-11-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"/>
<link rel="next" href="learning-policies-versus-learning-values.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Reinforcement Learning in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> <strong>Understanding Reinforcement Learning: From Bandits to Policy Optimization</strong></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction-to-reinforcement-learning"><i class="fa fa-check"></i><b>1.1</b> Introduction to Reinforcement Learning</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#the-multi-armed-bandit-the-simplest-case"><i class="fa fa-check"></i><b>1.2</b> The Multi-Armed Bandit: The Simplest Case</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#transition-to-markov-decision-processes"><i class="fa fa-check"></i><b>1.3</b> Transition to Markov Decision Processes</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#comparing-reinforcement-learning-methods"><i class="fa fa-check"></i><b>1.4</b> Comparing Reinforcement Learning Methods</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#dynamic-programming-model-based-learning"><i class="fa fa-check"></i><b>1.4.1</b> Dynamic Programming: Model-Based Learning</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#model-free-approaches-monte-carlo-and-td-learning"><i class="fa fa-check"></i><b>1.4.2</b> Model-Free Approaches: Monte Carlo and TD Learning</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#dyna-bridging-model-free-and-model-based-learning"><i class="fa fa-check"></i><b>1.4.3</b> Dyna: Bridging Model-Free and Model-Based Learning</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#q-learning-and-function-approximation"><i class="fa fa-check"></i><b>1.4.4</b> Q-Learning and Function Approximation</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#policy-gradient-and-actor-critic-methods"><i class="fa fa-check"></i><b>1.4.5</b> Policy Gradient and Actor-Critic Methods</a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#advanced-policy-optimization-techniques"><i class="fa fa-check"></i><b>1.4.6</b> Advanced Policy Optimization Techniques</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#further-directions"><i class="fa fa-check"></i><b>1.5</b> Further Directions</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html"><i class="fa fa-check"></i><b>2</b> The Multi-Armed Bandit Problem</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html#mathematical-formalism"><i class="fa fa-check"></i><b>2.2</b> Mathematical Formalism</a></li>
<li class="chapter" data-level="2.3" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html#frequentist-approach-ucb1-algorithm"><i class="fa fa-check"></i><b>2.3</b> Frequentist Approach: UCB1 Algorithm</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html#r-code-for-ucb1"><i class="fa fa-check"></i><b>2.3.1</b> R Code for UCB1</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html#bayesian-approach-thompson-sampling"><i class="fa fa-check"></i><b>2.4</b> Bayesian Approach: Thompson Sampling</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html#r-code-for-thompson-sampling"><i class="fa fa-check"></i><b>2.4.1</b> R Code for Thompson Sampling</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html#epsilon-greedy-strategy"><i class="fa fa-check"></i><b>2.5</b> Epsilon-Greedy Strategy</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html#r-code-for-epsilon-greedy"><i class="fa fa-check"></i><b>2.5.1</b> R Code for Epsilon-Greedy</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html#summary-table"><i class="fa fa-check"></i><b>2.6</b> Summary Table</a></li>
<li class="chapter" data-level="2.7" data-path="the-multi-armed-bandit-problem.html"><a href="the-multi-armed-bandit-problem.html#conclusion"><i class="fa fa-check"></i><b>2.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="markov-decision-processes-and-dynamic-programming.html"><a href="markov-decision-processes-and-dynamic-programming.html"><i class="fa fa-check"></i><b>3</b> Markov Decision Processes and Dynamic Programming</a>
<ul>
<li class="chapter" data-level="3.1" data-path="markov-decision-processes-and-dynamic-programming.html"><a href="markov-decision-processes-and-dynamic-programming.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="markov-decision-processes-and-dynamic-programming.html"><a href="markov-decision-processes-and-dynamic-programming.html#constructing-the-mdp-in-r"><i class="fa fa-check"></i><b>3.2</b> Constructing the MDP in R</a></li>
<li class="chapter" data-level="3.3" data-path="markov-decision-processes-and-dynamic-programming.html"><a href="markov-decision-processes-and-dynamic-programming.html#value-iteration-algorithm"><i class="fa fa-check"></i><b>3.3</b> Value Iteration Algorithm</a></li>
<li class="chapter" data-level="3.4" data-path="markov-decision-processes-and-dynamic-programming.html"><a href="markov-decision-processes-and-dynamic-programming.html#evaluation-and-interpretation"><i class="fa fa-check"></i><b>3.4</b> Evaluation and Interpretation</a></li>
<li class="chapter" data-level="3.5" data-path="markov-decision-processes-and-dynamic-programming.html"><a href="markov-decision-processes-and-dynamic-programming.html#theoretical-properties-of-value-iteration"><i class="fa fa-check"></i><b>3.5</b> Theoretical Properties of Value Iteration</a></li>
<li class="chapter" data-level="3.6" data-path="markov-decision-processes-and-dynamic-programming.html"><a href="markov-decision-processes-and-dynamic-programming.html#summary-table-1"><i class="fa fa-check"></i><b>3.6</b> Summary Table</a></li>
<li class="chapter" data-level="3.7" data-path="markov-decision-processes-and-dynamic-programming.html"><a href="markov-decision-processes-and-dynamic-programming.html#conclusion-1"><i class="fa fa-check"></i><b>3.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><i class="fa fa-check"></i><b>4</b> Model-Free Reinforcement Learning: Temporal Difference and Monte Carlo Methods in R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#theoretical-background"><i class="fa fa-check"></i><b>4.2</b> Theoretical Background</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#temporal-difference-learning-q-learning"><i class="fa fa-check"></i><b>4.2.1</b> Temporal Difference Learning (Q-Learning)</a></li>
<li class="chapter" data-level="4.2.2" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#monte-carlo-methods"><i class="fa fa-check"></i><b>4.2.2</b> Monte Carlo Methods</a></li>
<li class="chapter" data-level="4.2.3" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#step-1-defining-the-environment-in-r"><i class="fa fa-check"></i><b>4.2.3</b> Step 1: Defining the Environment in R</a></li>
<li class="chapter" data-level="4.2.4" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#step-2-q-learning-implementation-in-r"><i class="fa fa-check"></i><b>4.2.4</b> Step 2: Q-Learning Implementation in R</a></li>
<li class="chapter" data-level="4.2.5" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#step-3-monte-carlo-every-visit-implementation"><i class="fa fa-check"></i><b>4.2.5</b> Step 3: Monte Carlo Every-Visit Implementation</a></li>
<li class="chapter" data-level="4.2.6" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#step-4-simulating-outcome-devaluation"><i class="fa fa-check"></i><b>4.2.6</b> Step 4: Simulating Outcome Devaluation</a></li>
<li class="chapter" data-level="4.2.7" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#step-5-comparing-policies-before-and-after-devaluation"><i class="fa fa-check"></i><b>4.2.7</b> Step 5: Comparing Policies Before and After Devaluation</a></li>
<li class="chapter" data-level="4.2.8" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#step-6-visualizing-the-policies"><i class="fa fa-check"></i><b>4.2.8</b> Step 6: Visualizing the Policies</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#interpretation-and-discussion"><i class="fa fa-check"></i><b>4.3</b> Interpretation and Discussion</a></li>
<li class="chapter" data-level="4.4" data-path="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html"><a href="model-free-reinforcement-learning-temporal-difference-and-monte-carlo-methods-in-r.html#conclusion-2"><i class="fa fa-check"></i><b>4.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html"><a href="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html"><i class="fa fa-check"></i><b>5</b> On-Policy vs Off-Policy Reinforcement Learning: SARSA, Q-Learning, and Monte Carlo in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html"><a href="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html"><a href="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html#sarsa-on-policy"><i class="fa fa-check"></i><b>5.2</b> SARSA (On-Policy)</a></li>
<li class="chapter" data-level="5.3" data-path="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html"><a href="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html#q-learning-off-policy"><i class="fa fa-check"></i><b>5.3</b> Q-Learning (Off-Policy)</a></li>
<li class="chapter" data-level="5.4" data-path="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html"><a href="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html#off-policy-monte-carlo-with-importance-sampling"><i class="fa fa-check"></i><b>5.4</b> Off-Policy Monte Carlo with Importance Sampling</a></li>
<li class="chapter" data-level="5.5" data-path="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html"><a href="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html#key-differences"><i class="fa fa-check"></i><b>5.5</b> Key Differences</a></li>
<li class="chapter" data-level="5.6" data-path="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html"><a href="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html#interpretation-and-discussion-1"><i class="fa fa-check"></i><b>5.6</b> Interpretation and Discussion</a></li>
<li class="chapter" data-level="5.7" data-path="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html"><a href="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html#conclusion-3"><i class="fa fa-check"></i><b>5.7</b> Conclusion</a></li>
<li class="chapter" data-level="5.8" data-path="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html"><a href="on-policy-vs-off-policy-reinforcement-learning-sarsa-q-learning-and-monte-carlo-in-r.html#comparison-table"><i class="fa fa-check"></i><b>5.8</b> Comparison Table</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="function-approximation-q-learning-with-linear-models.html"><a href="function-approximation-q-learning-with-linear-models.html"><i class="fa fa-check"></i><b>6</b> Function Approximation Q-Learning with Linear Models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="function-approximation-q-learning-with-linear-models.html"><a href="function-approximation-q-learning-with-linear-models.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="function-approximation-q-learning-with-linear-models.html"><a href="function-approximation-q-learning-with-linear-models.html#q-learning-with-function-approximation"><i class="fa fa-check"></i><b>6.1.1</b> Q-Learning with Function Approximation</a></li>
<li class="chapter" data-level="6.1.2" data-path="function-approximation-q-learning-with-linear-models.html"><a href="function-approximation-q-learning-with-linear-models.html#comparison-with-tabular-q-learning"><i class="fa fa-check"></i><b>6.1.2</b> Comparison with Tabular Q-Learning</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="function-approximation-q-learning-with-linear-models.html"><a href="function-approximation-q-learning-with-linear-models.html#r-implementation"><i class="fa fa-check"></i><b>6.2</b> R Implementation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html"><a href="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html"><i class="fa fa-check"></i><b>7</b> Beyond Linear Models: Q-Learning with Random Forest Function Approximation in R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html"><a href="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html"><a href="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html#q-learning-with-random-forest-approximation"><i class="fa fa-check"></i><b>7.1.1</b> Q-Learning with Random Forest Approximation</a></li>
<li class="chapter" data-level="7.1.2" data-path="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html"><a href="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html#comparison-with-previous-methods"><i class="fa fa-check"></i><b>7.1.2</b> Comparison with Previous Methods</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html"><a href="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html#r-implementation-1"><i class="fa fa-check"></i><b>7.2</b> R Implementation</a></li>
<li class="chapter" data-level="7.3" data-path="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html"><a href="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html#analysis-and-insights"><i class="fa fa-check"></i><b>7.3</b> Analysis and Insights</a></li>
<li class="chapter" data-level="7.4" data-path="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html"><a href="beyond-linear-models-q-learning-with-random-forest-function-approximation-in-r.html#conclusion-4"><i class="fa fa-check"></i><b>7.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><a href="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><i class="fa fa-check"></i><b>8</b> Deep Function Approximation: Q-Learning with Neural Networks in R</a>
<ul>
<li class="chapter" data-level="8.1" data-path="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><a href="deep-function-approximation-q-learning-with-neural-networks-in-r.html#introduction-6"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><a href="deep-function-approximation-q-learning-with-neural-networks-in-r.html#theoretical-foundation"><i class="fa fa-check"></i><b>8.2</b> Theoretical Foundation</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><a href="deep-function-approximation-q-learning-with-neural-networks-in-r.html#universal-approximation-and-expressivity"><i class="fa fa-check"></i><b>8.2.1</b> Universal Approximation and Expressivity</a></li>
<li class="chapter" data-level="8.2.2" data-path="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><a href="deep-function-approximation-q-learning-with-neural-networks-in-r.html#gradient-based-learning"><i class="fa fa-check"></i><b>8.2.2</b> Gradient-Based Learning</a></li>
<li class="chapter" data-level="8.2.3" data-path="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><a href="deep-function-approximation-q-learning-with-neural-networks-in-r.html#comparison-with-previous-approaches"><i class="fa fa-check"></i><b>8.2.3</b> Comparison with Previous Approaches</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><a href="deep-function-approximation-q-learning-with-neural-networks-in-r.html#r-implementation-2"><i class="fa fa-check"></i><b>8.3</b> R Implementation</a></li>
<li class="chapter" data-level="8.4" data-path="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><a href="deep-function-approximation-q-learning-with-neural-networks-in-r.html#analysis-and-interpretation"><i class="fa fa-check"></i><b>8.4</b> Analysis and Interpretation</a></li>
<li class="chapter" data-level="8.5" data-path="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><a href="deep-function-approximation-q-learning-with-neural-networks-in-r.html#future-directions"><i class="fa fa-check"></i><b>8.5</b> Future Directions</a></li>
<li class="chapter" data-level="8.6" data-path="deep-function-approximation-q-learning-with-neural-networks-in-r.html"><a href="deep-function-approximation-q-learning-with-neural-networks-in-r.html#conclusion-5"><i class="fa fa-check"></i><b>8.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html"><i class="fa fa-check"></i><b>9</b> Dyna and DynaQ</a>
<ul>
<li class="chapter" data-level="9.1" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#introduction-7"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#theoretical-framework"><i class="fa fa-check"></i><b>9.2</b> Theoretical Framework</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#the-dyna-architecture"><i class="fa fa-check"></i><b>9.2.1</b> The Dyna Architecture</a></li>
<li class="chapter" data-level="9.2.2" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#model-representation"><i class="fa fa-check"></i><b>9.2.2</b> Model Representation</a></li>
<li class="chapter" data-level="9.2.3" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#convergence-properties"><i class="fa fa-check"></i><b>9.2.3</b> Convergence Properties</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#implementation-in-r"><i class="fa fa-check"></i><b>9.3</b> Implementation in R</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#environment-setup"><i class="fa fa-check"></i><b>9.3.1</b> Environment Setup</a></li>
<li class="chapter" data-level="9.3.2" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#dyna-q-implementation"><i class="fa fa-check"></i><b>9.3.2</b> Dyna-Q Implementation</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#experimental-analysis"><i class="fa fa-check"></i><b>9.4</b> Experimental Analysis</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#learning-efficiency-comparison"><i class="fa fa-check"></i><b>9.4.1</b> Learning Efficiency Comparison</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#discussion"><i class="fa fa-check"></i><b>9.5</b> Discussion</a></li>
<li class="chapter" data-level="9.6" data-path="dyna-and-dynaq.html"><a href="dyna-and-dynaq.html#implementation-considerations-and-conclusion"><i class="fa fa-check"></i><b>9.6</b> Implementation Considerations and Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><i class="fa fa-check"></i><b>10</b> Dyna-Q+: Enhanced Exploration in Integrated Learning and Planning</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#introduction-8"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#theoretical-framework-1"><i class="fa fa-check"></i><b>10.2</b> Theoretical Framework</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#the-exploration-bonus-mechanism"><i class="fa fa-check"></i><b>10.2.1</b> The Exploration Bonus Mechanism</a></li>
<li class="chapter" data-level="10.2.2" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#complete-dyna-q-algorithm"><i class="fa fa-check"></i><b>10.2.2</b> Complete Dyna-Q+ Algorithm</a></li>
<li class="chapter" data-level="10.2.3" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#convergence-and-stability"><i class="fa fa-check"></i><b>10.2.3</b> Convergence and Stability</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#implementation-in-r-1"><i class="fa fa-check"></i><b>10.3</b> Implementation in R</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#environment-setup-1"><i class="fa fa-check"></i><b>10.3.1</b> Environment Setup</a></li>
<li class="chapter" data-level="10.3.2" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#dyna-q-implementation-1"><i class="fa fa-check"></i><b>10.3.2</b> Dyna-Q+ Implementation</a></li>
<li class="chapter" data-level="10.3.3" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#standard-dyna-for-comparison"><i class="fa fa-check"></i><b>10.3.3</b> Standard Dyna for Comparison</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#experimental-analysis-1"><i class="fa fa-check"></i><b>10.4</b> Experimental Analysis</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#adaptation-to-environmental-changes"><i class="fa fa-check"></i><b>10.4.1</b> Adaptation to Environmental Changes</a></li>
<li class="chapter" data-level="10.4.2" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#parameter-sensitivity-analysis"><i class="fa fa-check"></i><b>10.4.2</b> Parameter Sensitivity Analysis</a></li>
<li class="chapter" data-level="10.4.3" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#exploration-pattern-analysis"><i class="fa fa-check"></i><b>10.4.3</b> Exploration Pattern Analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#discussion-and-implementation-considerations"><i class="fa fa-check"></i><b>10.5</b> Discussion and Implementation Considerations</a></li>
<li class="chapter" data-level="10.6" data-path="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html"><a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html#conclusion-6"><i class="fa fa-check"></i><b>10.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html"><i class="fa fa-check"></i><b>11</b> Function Approximation And Feature Engineering</a>
<ul>
<li class="chapter" data-level="11.1" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#feature-engineering-and-state-representation"><i class="fa fa-check"></i><b>11.1</b> Feature Engineering and State Representation</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#the-discrimination-vs.-generalization-tradeoff"><i class="fa fa-check"></i><b>11.1.1</b> The Discrimination vs.Â Generalization Tradeoff</a></li>
<li class="chapter" data-level="11.1.2" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#principles-of-effective-feature-design"><i class="fa fa-check"></i><b>11.1.2</b> Principles of Effective Feature Design</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#mathematical-foundations-of-linear-function-approximation"><i class="fa fa-check"></i><b>11.2</b> Mathematical Foundations of Linear Function Approximation</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#linear-value-functions-and-their-properties"><i class="fa fa-check"></i><b>11.2.1</b> Linear Value Functions and Their Properties</a></li>
<li class="chapter" data-level="11.2.2" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#temporal-difference-learning-with-linear-approximation"><i class="fa fa-check"></i><b>11.2.2</b> Temporal Difference Learning with Linear Approximation</a></li>
<li class="chapter" data-level="11.2.3" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#the-deadly-triad-and-stability-concerns"><i class="fa fa-check"></i><b>11.2.3</b> The Deadly Triad and Stability Concerns</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#classical-basis-function-methods"><i class="fa fa-check"></i><b>11.3</b> Classical Basis Function Methods</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#coarse-coding-overlapping-receptive-fields"><i class="fa fa-check"></i><b>11.3.1</b> Coarse Coding: Overlapping Receptive Fields</a></li>
<li class="chapter" data-level="11.3.2" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#tile-coding-structured-overlapping-grids"><i class="fa fa-check"></i><b>11.3.2</b> Tile Coding: Structured Overlapping Grids</a></li>
<li class="chapter" data-level="11.3.3" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#radial-basis-functions-smooth-continuous-features"><i class="fa fa-check"></i><b>11.3.3</b> Radial Basis Functions: Smooth Continuous Features</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#comparative-analysis-and-practical-considerations"><i class="fa fa-check"></i><b>11.4</b> Comparative Analysis and Practical Considerations</a></li>
<li class="chapter" data-level="11.5" data-path="function-approximation-and-feature-engineering.html"><a href="function-approximation-and-feature-engineering.html#bridging-classical-and-modern-approaches"><i class="fa fa-check"></i><b>11.5</b> Bridging Classical and Modern Approaches</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="learning-policies-versus-learning-values.html"><a href="learning-policies-versus-learning-values.html"><i class="fa fa-check"></i><b>12</b> Learning Policies versus Learning Values:</a>
<ul>
<li class="chapter" data-level="12.1" data-path="learning-policies-versus-learning-values.html"><a href="learning-policies-versus-learning-values.html#the-two-paradigms-of-reinforcement-learning"><i class="fa fa-check"></i><b>12.1</b> The Two Paradigms of Reinforcement Learning</a></li>
<li class="chapter" data-level="12.2" data-path="learning-policies-versus-learning-values.html"><a href="learning-policies-versus-learning-values.html#value-based-methods-learning-worth-before-action"><i class="fa fa-check"></i><b>12.2</b> Value-Based Methods: Learning Worth Before Action</a></li>
<li class="chapter" data-level="12.3" data-path="learning-policies-versus-learning-values.html"><a href="learning-policies-versus-learning-values.html#policy-based-methods-direct-optimization-of-behavior"><i class="fa fa-check"></i><b>12.3</b> Policy-Based Methods: Direct Optimization of Behavior</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="learning-policies-versus-learning-values.html"><a href="learning-policies-versus-learning-values.html#the-policy-gradient-theorem"><i class="fa fa-check"></i><b>12.3.1</b> The Policy Gradient Theorem</a></li>
<li class="chapter" data-level="12.3.2" data-path="learning-policies-versus-learning-values.html"><a href="learning-policies-versus-learning-values.html#variance-reduction-through-baselines"><i class="fa fa-check"></i><b>12.3.2</b> Variance Reduction Through Baselines</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="learning-policies-versus-learning-values.html"><a href="learning-policies-versus-learning-values.html#conclusion-7"><i class="fa fa-check"></i><b>12.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><i class="fa fa-check"></i><b>13</b> Average Reward in Reinforcement Learning: A Comprehensive Guide</a>
<ul>
<li class="chapter" data-level="13.1" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html#the-limitations-of-discounted-reward-formulations"><i class="fa fa-check"></i><b>13.1</b> The Limitations of Discounted Reward Formulations</a></li>
<li class="chapter" data-level="13.2" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html#the-average-reward-alternative-theoretical-foundations"><i class="fa fa-check"></i><b>13.2</b> The Average Reward Alternative: Theoretical Foundations</a></li>
<li class="chapter" data-level="13.3" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html#value-functions-in-the-average-reward-setting"><i class="fa fa-check"></i><b>13.3</b> Value Functions in the Average Reward Setting</a></li>
<li class="chapter" data-level="13.4" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html#optimality-theory-for-average-reward"><i class="fa fa-check"></i><b>13.4</b> Optimality Theory for Average Reward</a></li>
<li class="chapter" data-level="13.5" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html#learning-algorithms-for-average-reward"><i class="fa fa-check"></i><b>13.5</b> Learning Algorithms for Average Reward</a></li>
<li class="chapter" data-level="13.6" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html#practical-implementation-patient-triage-in-emergency-department"><i class="fa fa-check"></i><b>13.6</b> Practical Implementation: Patient Triage in Emergency Department</a></li>
<li class="chapter" data-level="13.7" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html#implementation-considerations"><i class="fa fa-check"></i><b>13.7</b> Implementation Considerations</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html#convergence-of-average-reward-td-learning"><i class="fa fa-check"></i><b>13.7.1</b> Convergence of Average Reward TD Learning</a></li>
<li class="chapter" data-level="13.7.2" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html#policy-gradient-theorem-for-average-reward"><i class="fa fa-check"></i><b>13.7.2</b> Policy Gradient Theorem for Average Reward</a></li>
<li class="chapter" data-level="13.7.3" data-path="average-reward-in-reinforcement-learning-a-comprehensive-guide.html"><a href="average-reward-in-reinforcement-learning-a-comprehensive-guide.html#optimality-equations-derivation"><i class="fa fa-check"></i><b>13.7.3</b> Optimality Equations Derivation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="eligibility-traces.html"><a href="eligibility-traces.html"><i class="fa fa-check"></i><b>14</b> Eligibility Traces</a>
<ul>
<li class="chapter" data-level="14.1" data-path="eligibility-traces.html"><a href="eligibility-traces.html#from-one-step-to-multi-step-learning"><i class="fa fa-check"></i><b>14.1</b> From One-Step to Multi-Step Learning</a></li>
<li class="chapter" data-level="14.2" data-path="eligibility-traces.html"><a href="eligibility-traces.html#the-mechanics-of-eligibility-traces-a-backward-view"><i class="fa fa-check"></i><b>14.2</b> The Mechanics of Eligibility Traces: A Backward View</a></li>
<li class="chapter" data-level="14.3" data-path="eligibility-traces.html"><a href="eligibility-traces.html#the-tdlambda-algorithm-for-prediction"><i class="fa fa-check"></i><b>14.3</b> The TD(<span class="math inline">\(`\lambda`\)</span>) Algorithm for Prediction</a></li>
<li class="chapter" data-level="14.4" data-path="eligibility-traces.html"><a href="eligibility-traces.html#control-with-eligibility-traces-average-reward-sarsalambda"><i class="fa fa-check"></i><b>14.4</b> Control with Eligibility Traces: Average Reward Sarsa(<span class="math inline">\(`\lambda`\)</span>)</a></li>
<li class="chapter" data-level="14.5" data-path="eligibility-traces.html"><a href="eligibility-traces.html#practical-implementation-server-load-balancing-with-sarsalambda"><i class="fa fa-check"></i><b>14.5</b> Practical Implementation: Server Load Balancing with Sarsa(<span class="math inline">\(`\lambda`\)</span>)</a></li>
<li class="chapter" data-level="14.6" data-path="eligibility-traces.html"><a href="eligibility-traces.html#computational-and-performance-considerations"><i class="fa fa-check"></i><b>14.6</b> Computational and Performance Considerations</a></li>
<li class="chapter" data-level="14.7" data-path="eligibility-traces.html"><a href="eligibility-traces.html#conclusion-8"><i class="fa fa-check"></i><b>14.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html"><i class="fa fa-check"></i><b>15</b> Intrinsic Rewards</a>
<ul>
<li class="chapter" data-level="15.1" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html#the-sparse-reward-problem-and-its-implications"><i class="fa fa-check"></i><b>15.1</b> The Sparse Reward Problem and Its Implications</a></li>
<li class="chapter" data-level="15.2" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html#mathematical-foundations-of-intrinsic-motivation"><i class="fa fa-check"></i><b>15.2</b> Mathematical Foundations of Intrinsic Motivation</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html#curiosity-driven-learning"><i class="fa fa-check"></i><b>15.2.1</b> Curiosity-Driven Learning</a></li>
<li class="chapter" data-level="15.2.2" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html#count-based-exploration"><i class="fa fa-check"></i><b>15.2.2</b> Count-Based Exploration</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html#practical-implementation-curiosity-driven-grid-world-navigation"><i class="fa fa-check"></i><b>15.3</b> Practical Implementation: Curiosity-Driven Grid World Navigation</a></li>
<li class="chapter" data-level="15.4" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html#advanced-intrinsic-motivation-mechanisms"><i class="fa fa-check"></i><b>15.4</b> Advanced Intrinsic Motivation Mechanisms</a></li>
<li class="chapter" data-level="15.5" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html#implementation-considerations-and-practical-guidelines"><i class="fa fa-check"></i><b>15.5</b> Implementation Considerations and Practical Guidelines</a></li>
<li class="chapter" data-level="15.6" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html#theoretical-analysis-and-convergence-properties"><i class="fa fa-check"></i><b>15.6</b> Theoretical Analysis and Convergence Properties</a></li>
<li class="chapter" data-level="15.7" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html#applications-and-empirical-results"><i class="fa fa-check"></i><b>15.7</b> Applications and Empirical Results</a></li>
<li class="chapter" data-level="15.8" data-path="intrinsic-rewards.html"><a href="intrinsic-rewards.html#limitations-and-future-directions"><i class="fa fa-check"></i><b>15.8</b> Limitations and Future Directions</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><i class="fa fa-check"></i><b>16</b> Policy Gradients: Direct Optimization of Action Selection in Reinforcement Learning</a>
<ul>
<li class="chapter" data-level="16.1" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#introduction-9"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#theoretical-framework-2"><i class="fa fa-check"></i><b>16.2</b> Theoretical Framework</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#the-policy-gradient-theorem-1"><i class="fa fa-check"></i><b>16.2.1</b> The Policy Gradient Theorem</a></li>
<li class="chapter" data-level="16.2.2" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#reinforce-algorithm"><i class="fa fa-check"></i><b>16.2.2</b> REINFORCE Algorithm</a></li>
<li class="chapter" data-level="16.2.3" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#baseline-subtraction-and-variance-reduction"><i class="fa fa-check"></i><b>16.2.3</b> Baseline Subtraction and Variance Reduction</a></li>
<li class="chapter" data-level="16.2.4" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#softmax-policy-parameterization"><i class="fa fa-check"></i><b>16.2.4</b> Softmax Policy Parameterization</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#implementation-in-r-2"><i class="fa fa-check"></i><b>16.3</b> Implementation in R</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#environment-and-feature-representation"><i class="fa fa-check"></i><b>16.3.1</b> Environment and Feature Representation</a></li>
<li class="chapter" data-level="16.3.2" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#softmax-policy-implementation"><i class="fa fa-check"></i><b>16.3.2</b> Softmax Policy Implementation</a></li>
<li class="chapter" data-level="16.3.3" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#reinforce-implementation"><i class="fa fa-check"></i><b>16.3.3</b> REINFORCE Implementation</a></li>
<li class="chapter" data-level="16.3.4" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#actor-critic-implementation"><i class="fa fa-check"></i><b>16.3.4</b> Actor-Critic Implementation</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#experimental-analysis-2"><i class="fa fa-check"></i><b>16.4</b> Experimental Analysis</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#comparison-of-policy-gradient-variants"><i class="fa fa-check"></i><b>16.4.1</b> Comparison of Policy Gradient Variants</a></li>
<li class="chapter" data-level="16.4.2" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#learning-rate-sensitivity-analysis"><i class="fa fa-check"></i><b>16.4.2</b> Learning Rate Sensitivity Analysis</a></li>
<li class="chapter" data-level="16.4.3" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#variance-analysis-of-gradient-estimates"><i class="fa fa-check"></i><b>16.4.3</b> Variance Analysis of Gradient Estimates</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#discussion-and-implementation-considerations-1"><i class="fa fa-check"></i><b>16.5</b> Discussion and Implementation Considerations</a></li>
<li class="chapter" data-level="16.6" data-path="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html"><a href="policy-gradients-direct-optimization-of-action-selection-in-reinforcement-learning.html#conclusion-9"><i class="fa fa-check"></i><b>16.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html"><a href="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html"><i class="fa fa-check"></i><b>17</b> Actor-Critic Methods: Bridging Policy and Value Learning in Reinforcement Learning</a>
<ul>
<li class="chapter" data-level="17.1" data-path="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html"><a href="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html#theoretical-framework-3"><i class="fa fa-check"></i><b>17.1</b> Theoretical Framework</a></li>
<li class="chapter" data-level="17.2" data-path="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html"><a href="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html#implementation-and-comparative-analysis"><i class="fa fa-check"></i><b>17.2</b> Implementation and Comparative Analysis</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html"><a href="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html#variance-analysis-and-learning-dynamics"><i class="fa fa-check"></i><b>17.2.1</b> Variance Analysis and Learning Dynamics</a></li>
<li class="chapter" data-level="17.2.2" data-path="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html"><a href="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html#algorithmic-variants-and-extensions"><i class="fa fa-check"></i><b>17.2.2</b> Algorithmic Variants and Extensions</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html"><a href="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html#computational-and-convergence-considerations"><i class="fa fa-check"></i><b>17.3</b> Computational and Convergence Considerations</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html"><a href="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html#comparative-performance-analysis"><i class="fa fa-check"></i><b>17.3.1</b> Comparative Performance Analysis</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html"><a href="actor-critic-methods-bridging-policy-and-value-learning-in-reinforcement-learning.html#conclusion-10"><i class="fa fa-check"></i><b>17.4</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>18</b> Appendix</a>
<ul>
<li class="chapter" data-level="18.1" data-path="appendix.html"><a href="appendix.html#comprehensive-reinforcement-learning-concepts-guide"><i class="fa fa-check"></i><b>18.1</b> Comprehensive Reinforcement Learning Concepts Guide</a></li>
<li class="chapter" data-level="18.2" data-path="appendix.html"><a href="appendix.html#learning-mechanisms"><i class="fa fa-check"></i><b>18.2</b> Learning Mechanisms</a></li>
<li class="chapter" data-level="18.3" data-path="appendix.html"><a href="appendix.html#environment-properties"><i class="fa fa-check"></i><b>18.3</b> Environment Properties</a></li>
<li class="chapter" data-level="18.4" data-path="appendix.html"><a href="appendix.html#learning-paradigms"><i class="fa fa-check"></i><b>18.4</b> Learning Paradigms</a></li>
<li class="chapter" data-level="18.5" data-path="appendix.html"><a href="appendix.html#exploration-strategies"><i class="fa fa-check"></i><b>18.5</b> Exploration Strategies</a></li>
<li class="chapter" data-level="18.6" data-path="appendix.html"><a href="appendix.html#key-algorithms-methods"><i class="fa fa-check"></i><b>18.6</b> Key Algorithms &amp; Methods</a></li>
<li class="chapter" data-level="18.7" data-path="appendix.html"><a href="appendix.html#advanced-concepts"><i class="fa fa-check"></i><b>18.7</b> Advanced Concepts</a></li>
<li class="chapter" data-level="18.8" data-path="appendix.html"><a href="appendix.html#fundamental-equations"><i class="fa fa-check"></i><b>18.8</b> Fundamental Equations</a>
<ul>
<li class="chapter" data-level="18.8.1" data-path="appendix.html"><a href="appendix.html#bellman-equations"><i class="fa fa-check"></i><b>18.8.1</b> <strong>Bellman Equations</strong></a></li>
<li class="chapter" data-level="18.8.2" data-path="appendix.html"><a href="appendix.html#policy-gradient-theorem"><i class="fa fa-check"></i><b>18.8.2</b> <strong>Policy Gradient Theorem</strong></a></li>
<li class="chapter" data-level="18.8.3" data-path="appendix.html"><a href="appendix.html#temporal-difference-error"><i class="fa fa-check"></i><b>18.8.3</b> <strong>Temporal Difference Error</strong></a></li>
</ul></li>
<li class="chapter" data-level="18.9" data-path="appendix.html"><a href="appendix.html#common-challenges-solutions"><i class="fa fa-check"></i><b>18.9</b> Common Challenges &amp; Solutions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reinforcement Learning in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="function-approximation-and-feature-engineering" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> Function Approximation And Feature Engineering<a href="function-approximation-and-feature-engineering.html#function-approximation-and-feature-engineering" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Reinforcement Learning has evolved dramatically from its tabular origins, where algorithms stored explicit values for every state-action pair. Modern deep RL agents navigate vast continuous environments that would be impossible to represent in lookup tables. This transformation rests on a crucial foundation that bridges tabular methods and neural networks: classical function approximation. Understanding linear function approximation, basis functions, and feature engineering illuminates why deep RL succeeds, helps diagnose failures, and guides the design of effective agent representations.</p>
<p>The curse of dimensionality makes tabular RL impractical for realistic problems. Consider a robot with ten continuous state variables, each discretized into just 100 binsâthe resulting state space contains 10^20 states, far exceeding what any computer could store. Function approximation solves this by learning parameterized functions that generalize knowledge across similar states. This generalization creates both opportunities and challenges, introducing a fundamental tension between discrimination (the ability to distinguish important differences) and generalization (the capacity to share knowledge) that shapes every modern RL algorithm.</p>
<p>This appendix provides the conceptual bridge between simple tabular methods and sophisticated neural networks. We explore how to engineer effective features, examine the mathematical principles governing linear function approximation, and investigate classical basis functions that remain relevant in contemporary RL systems.</p>
<div id="feature-engineering-and-state-representation" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Feature Engineering and State Representation<a href="function-approximation-and-feature-engineering.html#feature-engineering-and-state-representation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The quality of state representation often determines the success or failure of RL algorithms more than the choice of learning method itself. Raw environmental observationsâsensor readings, pixel values, or game statesârarely provide the optimal format for learning. Effective feature engineering transforms these high-dimensional, noisy inputs into compact, informative representations that accelerate learning and improve policy performance.</p>
<p>Consider a autonomous vehicle navigating city streets. Raw sensor data might include thousands of LIDAR points, camera pixels, and instrument readings. However, the agentâs success depends on recognizing higher-level patterns: the presence of pedestrians, the curvature of the road ahead, or the relative positions of nearby vehicles. Good features capture these essential abstractions while discarding irrelevant details like the exact shade of a building or the precise timestamp of the observation.</p>
<div id="the-discrimination-vs.-generalization-tradeoff" class="section level3 hasAnchor" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> The Discrimination vs.Â Generalization Tradeoff<a href="function-approximation-and-feature-engineering.html#the-discrimination-vs.-generalization-tradeoff" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>At the heart of feature design lies a fundamental tension that permeates all of machine learning but becomes particularly acute in RL. Discrimination enables the agent to recognize when seemingly similar states require different actions. A chess program must distinguish between positions that appear nearly identical but have vastly different strategic implications. Generalization allows the agent to apply lessons learned in one context to new, similar situations. The same chess program should recognize that tactical patterns transfer across different board positions.</p>
<p>Mathematically, we seek to approximate the true value function V*(s) using a parameterized function V_Î¸(s). In the linear case, this takes the form:</p>
<p>V_Î¸(s) = Ï(s)^T Î¸ = Î£_{i=1}^d Ï_i(s) Î¸_i</p>
<p>The feature vector Ï(s) determines what information the agent can access about state s, while the weight vector Î¸ contains the learned parameters. The approximation quality depends critically on how well the feature space can represent the true value function. The theoretical limit of linear approximation is given by the projection error |V* - Î V*|^2, where Î  projects onto the space spanned by the features.</p>
<p>This mathematical framework reveals why feature selection is so crucial. No amount of sophisticated learning can overcome fundamentally inadequate features. If the feature vector Ï(s) cannot distinguish between states with different optimal values, the agent cannot learn the correct policy regardless of the learning algorithm used.</p>
</div>
<div id="principles-of-effective-feature-design" class="section level3 hasAnchor" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> Principles of Effective Feature Design<a href="function-approximation-and-feature-engineering.html#principles-of-effective-feature-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Successful RL features often encode temporal structure, highlighting how the environment evolves over time. In physical systems, this means capturing both position and velocity. In financial applications, it involves representing price trends alongside current values. The key insight is that optimal actions depend not just on the current state, but on the trajectory that led to it.</p>
<p>Features should focus on action-relevant information while filtering out distracting details. A poker-playing agent needs to represent card values, betting patterns, and opponent tendencies, but the color of the cards or the time of day are irrelevant. This filtering process requires domain knowledge and careful analysis of what information actually influences optimal decision-making.</p>
<p>Hierarchical structure in features enables agents to reason at multiple levels of abstraction. A household robot benefits from features that represent both fine-grained spatial information (ânear the kitchen counterâ) and higher-level semantic concepts (âin the cooking areaâ). This hierarchical representation supports both precise control and strategic planning.</p>
</div>
</div>
<div id="mathematical-foundations-of-linear-function-approximation" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Mathematical Foundations of Linear Function Approximation<a href="function-approximation-and-feature-engineering.html#mathematical-foundations-of-linear-function-approximation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Linear function approximation provides the theoretical foundation for understanding more complex methods. Its mathematical simplicity enables rigorous analysis while its computational efficiency makes it practical for many applications. Most importantly, the insights gained from linear methods transfer directly to neural network approaches.</p>
<div id="linear-value-functions-and-their-properties" class="section level3 hasAnchor" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Linear Value Functions and Their Properties<a href="function-approximation-and-feature-engineering.html#linear-value-functions-and-their-properties" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The linear model represents value functions as weighted combinations of features:</p>
<p>V_Î¸(s) = Ï(s)^T Î¸
Q_Î¸(s,a) = Ï(s,a)^T Î¸</p>
<p>This representation has several appealing properties. The gradient with respect to parameters is simply the feature vector itself: â_Î¸ V_Î¸(s) = Ï(s). This makes gradient-based learning algorithms straightforward to implement and analyze. The update rules become linear in the features, ensuring computational efficiency even for high-dimensional feature spaces.</p>
<p>Linear models also provide theoretical guarantees. Under certain conditions, they converge to the best possible approximation within the representational constraints. This convergence behavior can be analyzed using techniques from linear algebra and optimization theory, providing insights that remain valuable when working with more complex function approximators.</p>
</div>
<div id="temporal-difference-learning-with-linear-approximation" class="section level3 hasAnchor" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Temporal Difference Learning with Linear Approximation<a href="function-approximation-and-feature-engineering.html#temporal-difference-learning-with-linear-approximation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The temporal difference learning framework adapts naturally to linear function approximation. The TD(0) update rule becomes:</p>
<p>Î¸_{t+1} â Î¸_t + Î± [R_{t+1} + Î³ V_Î¸(S_{t+1}) - V_Î¸(S_t)] Ï(S_t)</p>
<p>This update adjusts the weight vector to reduce the temporal difference error for the observed transition. Since all states share the same parameter vector Î¸, each update influences value estimates throughout the entire state space. The degree of influence depends on the similarity of feature vectors between states.</p>
<p>For action-value learning, the Q-learning update becomes:</p>
<p>Î¸_{t+1} â Î¸_t + Î± [R_{t+1} + Î³ max_{aâ} Q_Î¸(S_{t+1}, aâ) - Q_Î¸(S_t, A_t)] Ï(S_t, A_t)</p>
<p>These updates have intuitive interpretations. When the agent discovers that a state is more valuable than expected (positive TD error), it increases the weights corresponding to active features. States with similar feature representations receive proportional increases in their estimated values.</p>
</div>
<div id="the-deadly-triad-and-stability-concerns" class="section level3 hasAnchor" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> The Deadly Triad and Stability Concerns<a href="function-approximation-and-feature-engineering.html#the-deadly-triad-and-stability-concerns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Linear function approximation with on-policy TD learning enjoys strong convergence guarantees, but stability becomes problematic under certain combinations of conditions. The infamous âdeadly triadâ consists of off-policy learning (updating from data generated by a different policy), function approximation (using parameterized models rather than tabular representations), and bootstrapping (updating estimates based on other estimates rather than complete returns).</p>
<p>This instability isnât merely a theoretical curiosityâit represents a fundamental challenge that motivated much of the research leading to modern deep RL algorithms. Techniques like experience replay, target networks, and careful exploration strategies all address various aspects of this stability problem. Understanding the deadly triad provides crucial intuition for diagnosing and fixing problems in deep RL systems.</p>
</div>
</div>
<div id="classical-basis-function-methods" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Classical Basis Function Methods<a href="function-approximation-and-feature-engineering.html#classical-basis-function-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Basis functions provide systematic approaches to feature construction, bridging the gap between hand-crafted features and automatically learned representations. These classical methods remain relevant both as standalone techniques for appropriate problems and as conceptual frameworks for understanding more sophisticated approaches.</p>
<div id="coarse-coding-overlapping-receptive-fields" class="section level3 hasAnchor" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Coarse Coding: Overlapping Receptive Fields<a href="function-approximation-and-feature-engineering.html#coarse-coding-overlapping-receptive-fields" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Coarse coding represents the state space using overlapping binary features, where each feature corresponds to a region or âreceptive field.â A feature activates when the state falls within its designated region and remains inactive otherwise. The power of this approach lies in the overlapping structureânearby states activate similar sets of features, creating natural generalization.</p>
<p>The degree of overlap controls the smoothness of the learned function. Greater overlap produces broader generalization but reduces discrimination. The optimal balance depends on the problem structure and the complexity of the target function. Coarse coding mimics biological neural representations, where individual neurons respond to ranges of stimuli with overlapping tuning curves.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="function-approximation-and-feature-engineering.html#cb128-1" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb128-2"><a href="function-approximation-and-feature-engineering.html#cb128-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb128-3"><a href="function-approximation-and-feature-engineering.html#cb128-3" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb128-4"><a href="function-approximation-and-feature-engineering.html#cb128-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb128-5"><a href="function-approximation-and-feature-engineering.html#cb128-5" tabindex="-1"></a></span>
<span id="cb128-6"><a href="function-approximation-and-feature-engineering.html#cb128-6" tabindex="-1"></a><span class="co"># Coarse Coding Implementation</span></span>
<span id="cb128-7"><a href="function-approximation-and-feature-engineering.html#cb128-7" tabindex="-1"></a>create_coarse_coder <span class="ot">&lt;-</span> <span class="cf">function</span>(state_dims, num_features, <span class="at">overlap_factor =</span> <span class="fl">1.5</span>, <span class="at">seed =</span> <span class="dv">123</span>) {</span>
<span id="cb128-8"><a href="function-approximation-and-feature-engineering.html#cb128-8" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb128-9"><a href="function-approximation-and-feature-engineering.html#cb128-9" tabindex="-1"></a>  </span>
<span id="cb128-10"><a href="function-approximation-and-feature-engineering.html#cb128-10" tabindex="-1"></a>  <span class="co"># Generate random centers uniformly across state space</span></span>
<span id="cb128-11"><a href="function-approximation-and-feature-engineering.html#cb128-11" tabindex="-1"></a>  centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb128-12"><a href="function-approximation-and-feature-engineering.html#cb128-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">runif</span>(num_features, <span class="dv">0</span>, state_dims[<span class="dv">1</span>]),</span>
<span id="cb128-13"><a href="function-approximation-and-feature-engineering.html#cb128-13" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">runif</span>(num_features, <span class="dv">0</span>, state_dims[<span class="dv">2</span>])</span>
<span id="cb128-14"><a href="function-approximation-and-feature-engineering.html#cb128-14" tabindex="-1"></a>  )</span>
<span id="cb128-15"><a href="function-approximation-and-feature-engineering.html#cb128-15" tabindex="-1"></a>  </span>
<span id="cb128-16"><a href="function-approximation-and-feature-engineering.html#cb128-16" tabindex="-1"></a>  <span class="co"># Calculate radius to ensure appropriate overlap</span></span>
<span id="cb128-17"><a href="function-approximation-and-feature-engineering.html#cb128-17" tabindex="-1"></a>  avg_spacing <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">prod</span>(state_dims) <span class="sc">/</span> num_features)</span>
<span id="cb128-18"><a href="function-approximation-and-feature-engineering.html#cb128-18" tabindex="-1"></a>  radius <span class="ot">&lt;-</span> overlap_factor <span class="sc">*</span> avg_spacing <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb128-19"><a href="function-approximation-and-feature-engineering.html#cb128-19" tabindex="-1"></a>  </span>
<span id="cb128-20"><a href="function-approximation-and-feature-engineering.html#cb128-20" tabindex="-1"></a>  <span class="co"># Function to compute binary feature vector for given state</span></span>
<span id="cb128-21"><a href="function-approximation-and-feature-engineering.html#cb128-21" tabindex="-1"></a>  encode <span class="ot">&lt;-</span> <span class="cf">function</span>(state) {</span>
<span id="cb128-22"><a href="function-approximation-and-feature-engineering.html#cb128-22" tabindex="-1"></a>    state_vec <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(state)</span>
<span id="cb128-23"><a href="function-approximation-and-feature-engineering.html#cb128-23" tabindex="-1"></a>    distances <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((centers<span class="sc">$</span>x <span class="sc">-</span> state_vec[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (centers<span class="sc">$</span>y <span class="sc">-</span> state_vec[<span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb128-24"><a href="function-approximation-and-feature-engineering.html#cb128-24" tabindex="-1"></a>    features <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(distances <span class="sc">&lt;=</span> radius)</span>
<span id="cb128-25"><a href="function-approximation-and-feature-engineering.html#cb128-25" tabindex="-1"></a>    <span class="fu">return</span>(features)</span>
<span id="cb128-26"><a href="function-approximation-and-feature-engineering.html#cb128-26" tabindex="-1"></a>  }</span>
<span id="cb128-27"><a href="function-approximation-and-feature-engineering.html#cb128-27" tabindex="-1"></a>  </span>
<span id="cb128-28"><a href="function-approximation-and-feature-engineering.html#cb128-28" tabindex="-1"></a>  <span class="co"># Visualization function</span></span>
<span id="cb128-29"><a href="function-approximation-and-feature-engineering.html#cb128-29" tabindex="-1"></a>  visualize <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">query_state =</span> <span class="cn">NULL</span>) {</span>
<span id="cb128-30"><a href="function-approximation-and-feature-engineering.html#cb128-30" tabindex="-1"></a>    <span class="co"># Determine active features for query state</span></span>
<span id="cb128-31"><a href="function-approximation-and-feature-engineering.html#cb128-31" tabindex="-1"></a>    active_features <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb128-32"><a href="function-approximation-and-feature-engineering.html#cb128-32" tabindex="-1"></a>    active_indices <span class="ot">&lt;-</span> <span class="fu">integer</span>(<span class="dv">0</span>)</span>
<span id="cb128-33"><a href="function-approximation-and-feature-engineering.html#cb128-33" tabindex="-1"></a>    </span>
<span id="cb128-34"><a href="function-approximation-and-feature-engineering.html#cb128-34" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(query_state)) {</span>
<span id="cb128-35"><a href="function-approximation-and-feature-engineering.html#cb128-35" tabindex="-1"></a>      active_features <span class="ot">&lt;-</span> <span class="fu">encode</span>(query_state)</span>
<span id="cb128-36"><a href="function-approximation-and-feature-engineering.html#cb128-36" tabindex="-1"></a>      active_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(active_features <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb128-37"><a href="function-approximation-and-feature-engineering.html#cb128-37" tabindex="-1"></a>    }</span>
<span id="cb128-38"><a href="function-approximation-and-feature-engineering.html#cb128-38" tabindex="-1"></a>    </span>
<span id="cb128-39"><a href="function-approximation-and-feature-engineering.html#cb128-39" tabindex="-1"></a>    <span class="co"># Create base plot</span></span>
<span id="cb128-40"><a href="function-approximation-and-feature-engineering.html#cb128-40" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb128-41"><a href="function-approximation-and-feature-engineering.html#cb128-41" tabindex="-1"></a>      <span class="fu">coord_fixed</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, state_dims[<span class="dv">1</span>]), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, state_dims[<span class="dv">2</span>]))</span>
<span id="cb128-42"><a href="function-approximation-and-feature-engineering.html#cb128-42" tabindex="-1"></a>    </span>
<span id="cb128-43"><a href="function-approximation-and-feature-engineering.html#cb128-43" tabindex="-1"></a>    <span class="co"># Add all receptive fields (inactive)</span></span>
<span id="cb128-44"><a href="function-approximation-and-feature-engineering.html#cb128-44" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_circle</span>(</span>
<span id="cb128-45"><a href="function-approximation-and-feature-engineering.html#cb128-45" tabindex="-1"></a>      <span class="at">data =</span> centers,</span>
<span id="cb128-46"><a href="function-approximation-and-feature-engineering.html#cb128-46" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x0 =</span> x, <span class="at">y0 =</span> y, <span class="at">r =</span> radius),</span>
<span id="cb128-47"><a href="function-approximation-and-feature-engineering.html#cb128-47" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;grey70&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span></span>
<span id="cb128-48"><a href="function-approximation-and-feature-engineering.html#cb128-48" tabindex="-1"></a>    )</span>
<span id="cb128-49"><a href="function-approximation-and-feature-engineering.html#cb128-49" tabindex="-1"></a>    </span>
<span id="cb128-50"><a href="function-approximation-and-feature-engineering.html#cb128-50" tabindex="-1"></a>    <span class="co"># Highlight active receptive fields</span></span>
<span id="cb128-51"><a href="function-approximation-and-feature-engineering.html#cb128-51" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(active_indices) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb128-52"><a href="function-approximation-and-feature-engineering.html#cb128-52" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_circle</span>(</span>
<span id="cb128-53"><a href="function-approximation-and-feature-engineering.html#cb128-53" tabindex="-1"></a>        <span class="at">data =</span> centers[active_indices, ],</span>
<span id="cb128-54"><a href="function-approximation-and-feature-engineering.html#cb128-54" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x0 =</span> x, <span class="at">y0 =</span> y, <span class="at">r =</span> radius),</span>
<span id="cb128-55"><a href="function-approximation-and-feature-engineering.html#cb128-55" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#e41a1c&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="dv">1</span></span>
<span id="cb128-56"><a href="function-approximation-and-feature-engineering.html#cb128-56" tabindex="-1"></a>      )</span>
<span id="cb128-57"><a href="function-approximation-and-feature-engineering.html#cb128-57" tabindex="-1"></a>    }</span>
<span id="cb128-58"><a href="function-approximation-and-feature-engineering.html#cb128-58" tabindex="-1"></a>    </span>
<span id="cb128-59"><a href="function-approximation-and-feature-engineering.html#cb128-59" tabindex="-1"></a>    <span class="co"># Add center points</span></span>
<span id="cb128-60"><a href="function-approximation-and-feature-engineering.html#cb128-60" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(</span>
<span id="cb128-61"><a href="function-approximation-and-feature-engineering.html#cb128-61" tabindex="-1"></a>      <span class="at">data =</span> centers, </span>
<span id="cb128-62"><a href="function-approximation-and-feature-engineering.html#cb128-62" tabindex="-1"></a>      <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), </span>
<span id="cb128-63"><a href="function-approximation-and-feature-engineering.html#cb128-63" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb128-64"><a href="function-approximation-and-feature-engineering.html#cb128-64" tabindex="-1"></a>    )</span>
<span id="cb128-65"><a href="function-approximation-and-feature-engineering.html#cb128-65" tabindex="-1"></a>    </span>
<span id="cb128-66"><a href="function-approximation-and-feature-engineering.html#cb128-66" tabindex="-1"></a>    <span class="co"># Add query state point</span></span>
<span id="cb128-67"><a href="function-approximation-and-feature-engineering.html#cb128-67" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(query_state)) {</span>
<span id="cb128-68"><a href="function-approximation-and-feature-engineering.html#cb128-68" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(</span>
<span id="cb128-69"><a href="function-approximation-and-feature-engineering.html#cb128-69" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> query_state[<span class="dv">1</span>], <span class="at">y =</span> query_state[<span class="dv">2</span>]), </span>
<span id="cb128-70"><a href="function-approximation-and-feature-engineering.html#cb128-70" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;#377eb8&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">17</span></span>
<span id="cb128-71"><a href="function-approximation-and-feature-engineering.html#cb128-71" tabindex="-1"></a>      )</span>
<span id="cb128-72"><a href="function-approximation-and-feature-engineering.html#cb128-72" tabindex="-1"></a>      </span>
<span id="cb128-73"><a href="function-approximation-and-feature-engineering.html#cb128-73" tabindex="-1"></a>      num_active <span class="ot">&lt;-</span> <span class="fu">length</span>(active_indices)</span>
<span id="cb128-74"><a href="function-approximation-and-feature-engineering.html#cb128-74" tabindex="-1"></a>      subtitle <span class="ot">&lt;-</span> <span class="fu">paste</span>(num_active, <span class="st">&quot;of&quot;</span>, num_features, <span class="st">&quot;features active&quot;</span>)</span>
<span id="cb128-75"><a href="function-approximation-and-feature-engineering.html#cb128-75" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb128-76"><a href="function-approximation-and-feature-engineering.html#cb128-76" tabindex="-1"></a>      subtitle <span class="ot">&lt;-</span> <span class="st">&quot;Overlapping receptive fields&quot;</span></span>
<span id="cb128-77"><a href="function-approximation-and-feature-engineering.html#cb128-77" tabindex="-1"></a>    }</span>
<span id="cb128-78"><a href="function-approximation-and-feature-engineering.html#cb128-78" tabindex="-1"></a>    </span>
<span id="cb128-79"><a href="function-approximation-and-feature-engineering.html#cb128-79" tabindex="-1"></a>    p <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb128-80"><a href="function-approximation-and-feature-engineering.html#cb128-80" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Coarse Coding&quot;</span>,</span>
<span id="cb128-81"><a href="function-approximation-and-feature-engineering.html#cb128-81" tabindex="-1"></a>      <span class="at">subtitle =</span> subtitle,</span>
<span id="cb128-82"><a href="function-approximation-and-feature-engineering.html#cb128-82" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;State Dimension 1&quot;</span>,</span>
<span id="cb128-83"><a href="function-approximation-and-feature-engineering.html#cb128-83" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;State Dimension 2&quot;</span></span>
<span id="cb128-84"><a href="function-approximation-and-feature-engineering.html#cb128-84" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb128-85"><a href="function-approximation-and-feature-engineering.html#cb128-85" tabindex="-1"></a>      <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb128-86"><a href="function-approximation-and-feature-engineering.html#cb128-86" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb128-87"><a href="function-approximation-and-feature-engineering.html#cb128-87" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb128-88"><a href="function-approximation-and-feature-engineering.html#cb128-88" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb128-89"><a href="function-approximation-and-feature-engineering.html#cb128-89" tabindex="-1"></a>      )</span>
<span id="cb128-90"><a href="function-approximation-and-feature-engineering.html#cb128-90" tabindex="-1"></a>  }</span>
<span id="cb128-91"><a href="function-approximation-and-feature-engineering.html#cb128-91" tabindex="-1"></a>  </span>
<span id="cb128-92"><a href="function-approximation-and-feature-engineering.html#cb128-92" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb128-93"><a href="function-approximation-and-feature-engineering.html#cb128-93" tabindex="-1"></a>    <span class="at">encode =</span> encode,</span>
<span id="cb128-94"><a href="function-approximation-and-feature-engineering.html#cb128-94" tabindex="-1"></a>    <span class="at">visualize =</span> visualize,</span>
<span id="cb128-95"><a href="function-approximation-and-feature-engineering.html#cb128-95" tabindex="-1"></a>    <span class="at">centers =</span> centers,</span>
<span id="cb128-96"><a href="function-approximation-and-feature-engineering.html#cb128-96" tabindex="-1"></a>    <span class="at">radius =</span> radius,</span>
<span id="cb128-97"><a href="function-approximation-and-feature-engineering.html#cb128-97" tabindex="-1"></a>    <span class="at">state_dims =</span> state_dims,</span>
<span id="cb128-98"><a href="function-approximation-and-feature-engineering.html#cb128-98" tabindex="-1"></a>    <span class="at">num_features =</span> num_features</span>
<span id="cb128-99"><a href="function-approximation-and-feature-engineering.html#cb128-99" tabindex="-1"></a>  ))</span>
<span id="cb128-100"><a href="function-approximation-and-feature-engineering.html#cb128-100" tabindex="-1"></a>}</span>
<span id="cb128-101"><a href="function-approximation-and-feature-engineering.html#cb128-101" tabindex="-1"></a></span>
<span id="cb128-102"><a href="function-approximation-and-feature-engineering.html#cb128-102" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb128-103"><a href="function-approximation-and-feature-engineering.html#cb128-103" tabindex="-1"></a>coarse_coder <span class="ot">&lt;-</span> <span class="fu">create_coarse_coder</span>(</span>
<span id="cb128-104"><a href="function-approximation-and-feature-engineering.html#cb128-104" tabindex="-1"></a>  <span class="at">state_dims =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), </span>
<span id="cb128-105"><a href="function-approximation-and-feature-engineering.html#cb128-105" tabindex="-1"></a>  <span class="at">num_features =</span> <span class="dv">50</span>, </span>
<span id="cb128-106"><a href="function-approximation-and-feature-engineering.html#cb128-106" tabindex="-1"></a>  <span class="at">overlap_factor =</span> <span class="fl">1.5</span></span>
<span id="cb128-107"><a href="function-approximation-and-feature-engineering.html#cb128-107" tabindex="-1"></a>)</span>
<span id="cb128-108"><a href="function-approximation-and-feature-engineering.html#cb128-108" tabindex="-1"></a></span>
<span id="cb128-109"><a href="function-approximation-and-feature-engineering.html#cb128-109" tabindex="-1"></a><span class="co"># Visualize with query state</span></span>
<span id="cb128-110"><a href="function-approximation-and-feature-engineering.html#cb128-110" tabindex="-1"></a><span class="fu">print</span>(coarse_coder<span class="sc">$</span><span class="fu">visualize</span>(<span class="at">query_state =</span> <span class="fu">c</span>(<span class="fl">3.2</span>, <span class="fl">7.8</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="tile-coding-structured-overlapping-grids" class="section level3 hasAnchor" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> Tile Coding: Structured Overlapping Grids<a href="function-approximation-and-feature-engineering.html#tile-coding-structured-overlapping-grids" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Tile coding, also known as CMAC (Cerebellar Model Articulation Controller), provides a more structured approach to creating overlapping features. Instead of random circular regions, tile coding partitions the state space using multiple offset grids called tilings. Each tiling covers the entire state space with non-overlapping rectangular tiles, but the tilings are offset from each other to create overlapping coverage.</p>
<p>For any given state, exactly one tile from each tiling will be active, ensuring a constant number of active features regardless of the state location. This property provides computational advantages and makes the learning dynamics more predictable. The offsets between tilings create fine-grained discrimination capability, while the tile sizes control the degree of generalization.</p>
<p>Tile codingâs rectangular structure creates asymmetric generalization that aligns with coordinate axes. This asymmetry is often desirable in control problems where different state dimensions represent distinct physical quantities with different units and scaling properties. A robotâs position and velocity, for example, should generalize differently along each dimension.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="function-approximation-and-feature-engineering.html#cb129-1" tabindex="-1"></a><span class="co"># Tile Coding Implementation</span></span>
<span id="cb129-2"><a href="function-approximation-and-feature-engineering.html#cb129-2" tabindex="-1"></a>create_tile_coder <span class="ot">&lt;-</span> <span class="cf">function</span>(state_low, state_high, num_tilings, tiles_per_dim) {</span>
<span id="cb129-3"><a href="function-approximation-and-feature-engineering.html#cb129-3" tabindex="-1"></a>  state_low <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(state_low)</span>
<span id="cb129-4"><a href="function-approximation-and-feature-engineering.html#cb129-4" tabindex="-1"></a>  state_high <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(state_high)</span>
<span id="cb129-5"><a href="function-approximation-and-feature-engineering.html#cb129-5" tabindex="-1"></a>  tiles_per_dim <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(tiles_per_dim)</span>
<span id="cb129-6"><a href="function-approximation-and-feature-engineering.html#cb129-6" tabindex="-1"></a>  </span>
<span id="cb129-7"><a href="function-approximation-and-feature-engineering.html#cb129-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(state_low) <span class="sc">!=</span> <span class="fu">length</span>(state_high)) {</span>
<span id="cb129-8"><a href="function-approximation-and-feature-engineering.html#cb129-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;state_low and state_high must have same length&quot;</span>)</span>
<span id="cb129-9"><a href="function-approximation-and-feature-engineering.html#cb129-9" tabindex="-1"></a>  }</span>
<span id="cb129-10"><a href="function-approximation-and-feature-engineering.html#cb129-10" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(tiles_per_dim <span class="sc">&lt;=</span> <span class="dv">0</span>)) {</span>
<span id="cb129-11"><a href="function-approximation-and-feature-engineering.html#cb129-11" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;tiles_per_dim must be positive integers&quot;</span>)</span>
<span id="cb129-12"><a href="function-approximation-and-feature-engineering.html#cb129-12" tabindex="-1"></a>  }</span>
<span id="cb129-13"><a href="function-approximation-and-feature-engineering.html#cb129-13" tabindex="-1"></a>  <span class="cf">if</span> (num_tilings <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb129-14"><a href="function-approximation-and-feature-engineering.html#cb129-14" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;num_tilings must be positive&quot;</span>)</span>
<span id="cb129-15"><a href="function-approximation-and-feature-engineering.html#cb129-15" tabindex="-1"></a>  }</span>
<span id="cb129-16"><a href="function-approximation-and-feature-engineering.html#cb129-16" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(state_low <span class="sc">&gt;=</span> state_high)) {</span>
<span id="cb129-17"><a href="function-approximation-and-feature-engineering.html#cb129-17" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Each element of state_low must be &lt; state_high&quot;</span>)</span>
<span id="cb129-18"><a href="function-approximation-and-feature-engineering.html#cb129-18" tabindex="-1"></a>  }</span>
<span id="cb129-19"><a href="function-approximation-and-feature-engineering.html#cb129-19" tabindex="-1"></a>  </span>
<span id="cb129-20"><a href="function-approximation-and-feature-engineering.html#cb129-20" tabindex="-1"></a>  state_dims <span class="ot">&lt;-</span> <span class="fu">length</span>(state_low)</span>
<span id="cb129-21"><a href="function-approximation-and-feature-engineering.html#cb129-21" tabindex="-1"></a>  state_range <span class="ot">&lt;-</span> state_high <span class="sc">-</span> state_low</span>
<span id="cb129-22"><a href="function-approximation-and-feature-engineering.html#cb129-22" tabindex="-1"></a>  tile_widths <span class="ot">&lt;-</span> state_range <span class="sc">/</span> tiles_per_dim</span>
<span id="cb129-23"><a href="function-approximation-and-feature-engineering.html#cb129-23" tabindex="-1"></a>  </span>
<span id="cb129-24"><a href="function-approximation-and-feature-engineering.html#cb129-24" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(tile_widths <span class="sc">&lt;=</span> <span class="dv">0</span>)) {</span>
<span id="cb129-25"><a href="function-approximation-and-feature-engineering.html#cb129-25" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Invalid state range or tiles_per_dim leading to non-positive tile width&quot;</span>)</span>
<span id="cb129-26"><a href="function-approximation-and-feature-engineering.html#cb129-26" tabindex="-1"></a>  }</span>
<span id="cb129-27"><a href="function-approximation-and-feature-engineering.html#cb129-27" tabindex="-1"></a>  </span>
<span id="cb129-28"><a href="function-approximation-and-feature-engineering.html#cb129-28" tabindex="-1"></a>  <span class="co"># Generate offsets for each tiling</span></span>
<span id="cb129-29"><a href="function-approximation-and-feature-engineering.html#cb129-29" tabindex="-1"></a>  offsets <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="dv">0</span>, <span class="at">dim =</span> <span class="fu">c</span>(num_tilings, state_dims))</span>
<span id="cb129-30"><a href="function-approximation-and-feature-engineering.html#cb129-30" tabindex="-1"></a>  <span class="cf">for</span> (dim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>state_dims) {</span>
<span id="cb129-31"><a href="function-approximation-and-feature-engineering.html#cb129-31" tabindex="-1"></a>    offsets[, dim] <span class="ot">&lt;-</span> (<span class="dv">0</span><span class="sc">:</span>(num_tilings <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> tile_widths[dim] <span class="sc">/</span> num_tilings</span>
<span id="cb129-32"><a href="function-approximation-and-feature-engineering.html#cb129-32" tabindex="-1"></a>  }</span>
<span id="cb129-33"><a href="function-approximation-and-feature-engineering.html#cb129-33" tabindex="-1"></a>  </span>
<span id="cb129-34"><a href="function-approximation-and-feature-engineering.html#cb129-34" tabindex="-1"></a>  <span class="co"># Function to get indices of active tiles for given state</span></span>
<span id="cb129-35"><a href="function-approximation-and-feature-engineering.html#cb129-35" tabindex="-1"></a>  encode <span class="ot">&lt;-</span> <span class="cf">function</span>(state) {</span>
<span id="cb129-36"><a href="function-approximation-and-feature-engineering.html#cb129-36" tabindex="-1"></a>    state_vec <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(state)</span>
<span id="cb129-37"><a href="function-approximation-and-feature-engineering.html#cb129-37" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(state_vec) <span class="sc">!=</span> state_dims) {</span>
<span id="cb129-38"><a href="function-approximation-and-feature-engineering.html#cb129-38" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;State dimension mismatch&quot;</span>)</span>
<span id="cb129-39"><a href="function-approximation-and-feature-engineering.html#cb129-39" tabindex="-1"></a>    }</span>
<span id="cb129-40"><a href="function-approximation-and-feature-engineering.html#cb129-40" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.finite</span>(state_vec))) {</span>
<span id="cb129-41"><a href="function-approximation-and-feature-engineering.html#cb129-41" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;State contains non-finite values&quot;</span>)</span>
<span id="cb129-42"><a href="function-approximation-and-feature-engineering.html#cb129-42" tabindex="-1"></a>    }</span>
<span id="cb129-43"><a href="function-approximation-and-feature-engineering.html#cb129-43" tabindex="-1"></a>    </span>
<span id="cb129-44"><a href="function-approximation-and-feature-engineering.html#cb129-44" tabindex="-1"></a>    active_tiles <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, num_tilings)</span>
<span id="cb129-45"><a href="function-approximation-and-feature-engineering.html#cb129-45" tabindex="-1"></a>    </span>
<span id="cb129-46"><a href="function-approximation-and-feature-engineering.html#cb129-46" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_tilings) {</span>
<span id="cb129-47"><a href="function-approximation-and-feature-engineering.html#cb129-47" tabindex="-1"></a>      <span class="co"># Apply offset and compute tile indices</span></span>
<span id="cb129-48"><a href="function-approximation-and-feature-engineering.html#cb129-48" tabindex="-1"></a>      offset_state <span class="ot">&lt;-</span> state_vec <span class="sc">-</span> state_low <span class="sc">+</span> offsets[t, ]</span>
<span id="cb129-49"><a href="function-approximation-and-feature-engineering.html#cb129-49" tabindex="-1"></a>      tile_indices <span class="ot">&lt;-</span> <span class="fu">floor</span>(offset_state <span class="sc">/</span> tile_widths)</span>
<span id="cb129-50"><a href="function-approximation-and-feature-engineering.html#cb129-50" tabindex="-1"></a>      </span>
<span id="cb129-51"><a href="function-approximation-and-feature-engineering.html#cb129-51" tabindex="-1"></a>      <span class="co"># Clip to valid range [0, tiles_per_dim - 1]</span></span>
<span id="cb129-52"><a href="function-approximation-and-feature-engineering.html#cb129-52" tabindex="-1"></a>      tile_indices <span class="ot">&lt;-</span> <span class="fu">pmax</span>(<span class="dv">0</span>, <span class="fu">pmin</span>(tile_indices, tiles_per_dim <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb129-53"><a href="function-approximation-and-feature-engineering.html#cb129-53" tabindex="-1"></a>      active_tiles[[t]] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(tile_indices)</span>
<span id="cb129-54"><a href="function-approximation-and-feature-engineering.html#cb129-54" tabindex="-1"></a>    }</span>
<span id="cb129-55"><a href="function-approximation-and-feature-engineering.html#cb129-55" tabindex="-1"></a>    <span class="fu">return</span>(active_tiles)</span>
<span id="cb129-56"><a href="function-approximation-and-feature-engineering.html#cb129-56" tabindex="-1"></a>  }</span>
<span id="cb129-57"><a href="function-approximation-and-feature-engineering.html#cb129-57" tabindex="-1"></a>  </span>
<span id="cb129-58"><a href="function-approximation-and-feature-engineering.html#cb129-58" tabindex="-1"></a>  <span class="co"># Visualization function (2D only)</span></span>
<span id="cb129-59"><a href="function-approximation-and-feature-engineering.html#cb129-59" tabindex="-1"></a>  visualize <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">query_state =</span> <span class="cn">NULL</span>) {</span>
<span id="cb129-60"><a href="function-approximation-and-feature-engineering.html#cb129-60" tabindex="-1"></a>    <span class="cf">if</span> (state_dims <span class="sc">!=</span> <span class="dv">2</span>) {</span>
<span id="cb129-61"><a href="function-approximation-and-feature-engineering.html#cb129-61" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;Visualization only supports 2D state spaces&quot;</span>)</span>
<span id="cb129-62"><a href="function-approximation-and-feature-engineering.html#cb129-62" tabindex="-1"></a>    }</span>
<span id="cb129-63"><a href="function-approximation-and-feature-engineering.html#cb129-63" tabindex="-1"></a>    </span>
<span id="cb129-64"><a href="function-approximation-and-feature-engineering.html#cb129-64" tabindex="-1"></a>    <span class="co"># Fix: extract scalar limits for x and y</span></span>
<span id="cb129-65"><a href="function-approximation-and-feature-engineering.html#cb129-65" tabindex="-1"></a>    xlims <span class="ot">&lt;-</span> <span class="fu">c</span>(state_low[<span class="dv">1</span>], state_high[<span class="dv">1</span>])</span>
<span id="cb129-66"><a href="function-approximation-and-feature-engineering.html#cb129-66" tabindex="-1"></a>    ylims <span class="ot">&lt;-</span> <span class="fu">c</span>(state_low[<span class="dv">2</span>], state_high[<span class="dv">2</span>])</span>
<span id="cb129-67"><a href="function-approximation-and-feature-engineering.html#cb129-67" tabindex="-1"></a>    </span>
<span id="cb129-68"><a href="function-approximation-and-feature-engineering.html#cb129-68" tabindex="-1"></a>    <span class="co"># Create base plot</span></span>
<span id="cb129-69"><a href="function-approximation-and-feature-engineering.html#cb129-69" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb129-70"><a href="function-approximation-and-feature-engineering.html#cb129-70" tabindex="-1"></a>      <span class="fu">coord_fixed</span>(<span class="at">xlim =</span> xlims, <span class="at">ylim =</span> ylims, <span class="at">expand =</span> <span class="cn">FALSE</span>)</span>
<span id="cb129-71"><a href="function-approximation-and-feature-engineering.html#cb129-71" tabindex="-1"></a>    </span>
<span id="cb129-72"><a href="function-approximation-and-feature-engineering.html#cb129-72" tabindex="-1"></a>    <span class="co"># Generate colors for tilings</span></span>
<span id="cb129-73"><a href="function-approximation-and-feature-engineering.html#cb129-73" tabindex="-1"></a>    colors <span class="ot">&lt;-</span> <span class="cf">if</span> (num_tilings <span class="sc">&lt;=</span> <span class="dv">8</span>) {</span>
<span id="cb129-74"><a href="function-approximation-and-feature-engineering.html#cb129-74" tabindex="-1"></a>      RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(num_tilings, <span class="st">&quot;Set1&quot;</span>)</span>
<span id="cb129-75"><a href="function-approximation-and-feature-engineering.html#cb129-75" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb129-76"><a href="function-approximation-and-feature-engineering.html#cb129-76" tabindex="-1"></a>      <span class="fu">rep</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;Set1&quot;</span>), <span class="at">length.out =</span> num_tilings)</span>
<span id="cb129-77"><a href="function-approximation-and-feature-engineering.html#cb129-77" tabindex="-1"></a>    }</span>
<span id="cb129-78"><a href="function-approximation-and-feature-engineering.html#cb129-78" tabindex="-1"></a>    </span>
<span id="cb129-79"><a href="function-approximation-and-feature-engineering.html#cb129-79" tabindex="-1"></a>    <span class="co"># Draw grid lines for each tiling</span></span>
<span id="cb129-80"><a href="function-approximation-and-feature-engineering.html#cb129-80" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_tilings) {</span>
<span id="cb129-81"><a href="function-approximation-and-feature-engineering.html#cb129-81" tabindex="-1"></a>      color <span class="ot">&lt;-</span> colors[t]</span>
<span id="cb129-82"><a href="function-approximation-and-feature-engineering.html#cb129-82" tabindex="-1"></a>      </span>
<span id="cb129-83"><a href="function-approximation-and-feature-engineering.html#cb129-83" tabindex="-1"></a>      <span class="co"># Vertical lines</span></span>
<span id="cb129-84"><a href="function-approximation-and-feature-engineering.html#cb129-84" tabindex="-1"></a>      x_start <span class="ot">&lt;-</span> state_low[<span class="dv">1</span>] <span class="sc">-</span> offsets[t, <span class="dv">1</span>]</span>
<span id="cb129-85"><a href="function-approximation-and-feature-engineering.html#cb129-85" tabindex="-1"></a>      x_end   <span class="ot">&lt;-</span> state_high[<span class="dv">1</span>] <span class="sc">+</span> tile_widths[<span class="dv">1</span>]</span>
<span id="cb129-86"><a href="function-approximation-and-feature-engineering.html#cb129-86" tabindex="-1"></a>      x_lines <span class="ot">&lt;-</span> <span class="fu">seq</span>(x_start, x_end, <span class="at">by =</span> tile_widths[<span class="dv">1</span>])</span>
<span id="cb129-87"><a href="function-approximation-and-feature-engineering.html#cb129-87" tabindex="-1"></a>      valid_x <span class="ot">&lt;-</span> x_lines[x_lines <span class="sc">&gt;=</span> state_low[<span class="dv">1</span>] <span class="sc">&amp;</span> x_lines <span class="sc">&lt;=</span> state_high[<span class="dv">1</span>]]</span>
<span id="cb129-88"><a href="function-approximation-and-feature-engineering.html#cb129-88" tabindex="-1"></a>      </span>
<span id="cb129-89"><a href="function-approximation-and-feature-engineering.html#cb129-89" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(valid_x) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">is.finite</span>(valid_x))) {</span>
<span id="cb129-90"><a href="function-approximation-and-feature-engineering.html#cb129-90" tabindex="-1"></a>        p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_vline</span>(</span>
<span id="cb129-91"><a href="function-approximation-and-feature-engineering.html#cb129-91" tabindex="-1"></a>          <span class="at">xintercept =</span> valid_x, </span>
<span id="cb129-92"><a href="function-approximation-and-feature-engineering.html#cb129-92" tabindex="-1"></a>          <span class="at">color =</span> color, </span>
<span id="cb129-93"><a href="function-approximation-and-feature-engineering.html#cb129-93" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb129-94"><a href="function-approximation-and-feature-engineering.html#cb129-94" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb129-95"><a href="function-approximation-and-feature-engineering.html#cb129-95" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.5</span></span>
<span id="cb129-96"><a href="function-approximation-and-feature-engineering.html#cb129-96" tabindex="-1"></a>        )</span>
<span id="cb129-97"><a href="function-approximation-and-feature-engineering.html#cb129-97" tabindex="-1"></a>      }</span>
<span id="cb129-98"><a href="function-approximation-and-feature-engineering.html#cb129-98" tabindex="-1"></a>      </span>
<span id="cb129-99"><a href="function-approximation-and-feature-engineering.html#cb129-99" tabindex="-1"></a>      <span class="co"># Horizontal lines</span></span>
<span id="cb129-100"><a href="function-approximation-and-feature-engineering.html#cb129-100" tabindex="-1"></a>      y_start <span class="ot">&lt;-</span> state_low[<span class="dv">2</span>] <span class="sc">-</span> offsets[t, <span class="dv">2</span>]</span>
<span id="cb129-101"><a href="function-approximation-and-feature-engineering.html#cb129-101" tabindex="-1"></a>      y_end   <span class="ot">&lt;-</span> state_high[<span class="dv">2</span>] <span class="sc">+</span> tile_widths[<span class="dv">2</span>]</span>
<span id="cb129-102"><a href="function-approximation-and-feature-engineering.html#cb129-102" tabindex="-1"></a>      y_lines <span class="ot">&lt;-</span> <span class="fu">seq</span>(y_start, y_end, <span class="at">by =</span> tile_widths[<span class="dv">2</span>])</span>
<span id="cb129-103"><a href="function-approximation-and-feature-engineering.html#cb129-103" tabindex="-1"></a>      valid_y <span class="ot">&lt;-</span> y_lines[y_lines <span class="sc">&gt;=</span> state_low[<span class="dv">2</span>] <span class="sc">&amp;</span> y_lines <span class="sc">&lt;=</span> state_high[<span class="dv">2</span>]]</span>
<span id="cb129-104"><a href="function-approximation-and-feature-engineering.html#cb129-104" tabindex="-1"></a>      </span>
<span id="cb129-105"><a href="function-approximation-and-feature-engineering.html#cb129-105" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(valid_y) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">all</span>(<span class="fu">is.finite</span>(valid_y))) {</span>
<span id="cb129-106"><a href="function-approximation-and-feature-engineering.html#cb129-106" tabindex="-1"></a>        p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_hline</span>(</span>
<span id="cb129-107"><a href="function-approximation-and-feature-engineering.html#cb129-107" tabindex="-1"></a>          <span class="at">yintercept =</span> valid_y, </span>
<span id="cb129-108"><a href="function-approximation-and-feature-engineering.html#cb129-108" tabindex="-1"></a>          <span class="at">color =</span> color, </span>
<span id="cb129-109"><a href="function-approximation-and-feature-engineering.html#cb129-109" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fl">0.7</span>, </span>
<span id="cb129-110"><a href="function-approximation-and-feature-engineering.html#cb129-110" tabindex="-1"></a>          <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, </span>
<span id="cb129-111"><a href="function-approximation-and-feature-engineering.html#cb129-111" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.5</span></span>
<span id="cb129-112"><a href="function-approximation-and-feature-engineering.html#cb129-112" tabindex="-1"></a>        )</span>
<span id="cb129-113"><a href="function-approximation-and-feature-engineering.html#cb129-113" tabindex="-1"></a>      }</span>
<span id="cb129-114"><a href="function-approximation-and-feature-engineering.html#cb129-114" tabindex="-1"></a>    }</span>
<span id="cb129-115"><a href="function-approximation-and-feature-engineering.html#cb129-115" tabindex="-1"></a>    </span>
<span id="cb129-116"><a href="function-approximation-and-feature-engineering.html#cb129-116" tabindex="-1"></a>    <span class="co"># Highlight active tiles for query state</span></span>
<span id="cb129-117"><a href="function-approximation-and-feature-engineering.html#cb129-117" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(query_state)) {</span>
<span id="cb129-118"><a href="function-approximation-and-feature-engineering.html#cb129-118" tabindex="-1"></a>      query_state <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(query_state)</span>
<span id="cb129-119"><a href="function-approximation-and-feature-engineering.html#cb129-119" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(query_state) <span class="sc">!=</span> <span class="dv">2</span> <span class="sc">||</span> <span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.finite</span>(query_state))) {</span>
<span id="cb129-120"><a href="function-approximation-and-feature-engineering.html#cb129-120" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;query_state must be a 2D finite numeric vector&quot;</span>)</span>
<span id="cb129-121"><a href="function-approximation-and-feature-engineering.html#cb129-121" tabindex="-1"></a>      }</span>
<span id="cb129-122"><a href="function-approximation-and-feature-engineering.html#cb129-122" tabindex="-1"></a>      </span>
<span id="cb129-123"><a href="function-approximation-and-feature-engineering.html#cb129-123" tabindex="-1"></a>      active_tiles_indices <span class="ot">&lt;-</span> <span class="fu">encode</span>(query_state)</span>
<span id="cb129-124"><a href="function-approximation-and-feature-engineering.html#cb129-124" tabindex="-1"></a>      </span>
<span id="cb129-125"><a href="function-approximation-and-feature-engineering.html#cb129-125" tabindex="-1"></a>      rect_data_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, num_tilings)</span>
<span id="cb129-126"><a href="function-approximation-and-feature-engineering.html#cb129-126" tabindex="-1"></a>      </span>
<span id="cb129-127"><a href="function-approximation-and-feature-engineering.html#cb129-127" tabindex="-1"></a>      <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_tilings) {</span>
<span id="cb129-128"><a href="function-approximation-and-feature-engineering.html#cb129-128" tabindex="-1"></a>        tile_indices <span class="ot">&lt;-</span> active_tiles_indices[[t]]</span>
<span id="cb129-129"><a href="function-approximation-and-feature-engineering.html#cb129-129" tabindex="-1"></a>        </span>
<span id="cb129-130"><a href="function-approximation-and-feature-engineering.html#cb129-130" tabindex="-1"></a>        <span class="co"># Reconstruct lower-left corner of tile in world coordinates</span></span>
<span id="cb129-131"><a href="function-approximation-and-feature-engineering.html#cb129-131" tabindex="-1"></a>        tile_x <span class="ot">&lt;-</span> state_low[<span class="dv">1</span>] <span class="sc">-</span> offsets[t, <span class="dv">1</span>] <span class="sc">+</span> tile_indices[<span class="dv">1</span>] <span class="sc">*</span> tile_widths[<span class="dv">1</span>]</span>
<span id="cb129-132"><a href="function-approximation-and-feature-engineering.html#cb129-132" tabindex="-1"></a>        tile_y <span class="ot">&lt;-</span> state_low[<span class="dv">2</span>] <span class="sc">-</span> offsets[t, <span class="dv">2</span>] <span class="sc">+</span> tile_indices[<span class="dv">2</span>] <span class="sc">*</span> tile_widths[<span class="dv">2</span>]</span>
<span id="cb129-133"><a href="function-approximation-and-feature-engineering.html#cb129-133" tabindex="-1"></a>        </span>
<span id="cb129-134"><a href="function-approximation-and-feature-engineering.html#cb129-134" tabindex="-1"></a>        rect_data_list[[t]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb129-135"><a href="function-approximation-and-feature-engineering.html#cb129-135" tabindex="-1"></a>          <span class="at">tiling =</span> t,</span>
<span id="cb129-136"><a href="function-approximation-and-feature-engineering.html#cb129-136" tabindex="-1"></a>          <span class="at">xmin =</span> tile_x,</span>
<span id="cb129-137"><a href="function-approximation-and-feature-engineering.html#cb129-137" tabindex="-1"></a>          <span class="at">xmax =</span> tile_x <span class="sc">+</span> tile_widths[<span class="dv">1</span>],</span>
<span id="cb129-138"><a href="function-approximation-and-feature-engineering.html#cb129-138" tabindex="-1"></a>          <span class="at">ymin =</span> tile_y,</span>
<span id="cb129-139"><a href="function-approximation-and-feature-engineering.html#cb129-139" tabindex="-1"></a>          <span class="at">ymax =</span> tile_y <span class="sc">+</span> tile_widths[<span class="dv">2</span>]</span>
<span id="cb129-140"><a href="function-approximation-and-feature-engineering.html#cb129-140" tabindex="-1"></a>        )</span>
<span id="cb129-141"><a href="function-approximation-and-feature-engineering.html#cb129-141" tabindex="-1"></a>      }</span>
<span id="cb129-142"><a href="function-approximation-and-feature-engineering.html#cb129-142" tabindex="-1"></a>      </span>
<span id="cb129-143"><a href="function-approximation-and-feature-engineering.html#cb129-143" tabindex="-1"></a>      all_rects <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, rect_data_list)</span>
<span id="cb129-144"><a href="function-approximation-and-feature-engineering.html#cb129-144" tabindex="-1"></a>      <span class="co"># Ensure all values are finite</span></span>
<span id="cb129-145"><a href="function-approximation-and-feature-engineering.html#cb129-145" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">all</span>(<span class="fu">is.finite</span>(<span class="fu">as.matrix</span>(all_rects[, <span class="fu">c</span>(<span class="st">&quot;xmin&quot;</span>, <span class="st">&quot;xmax&quot;</span>, <span class="st">&quot;ymin&quot;</span>, <span class="st">&quot;ymax&quot;</span>)])))) {</span>
<span id="cb129-146"><a href="function-approximation-and-feature-engineering.html#cb129-146" tabindex="-1"></a>        <span class="fu">warning</span>(<span class="st">&quot;Non-finite tile coordinates detected; skipping highlighting&quot;</span>)</span>
<span id="cb129-147"><a href="function-approximation-and-feature-engineering.html#cb129-147" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb129-148"><a href="function-approximation-and-feature-engineering.html#cb129-148" tabindex="-1"></a>        p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_rect</span>(</span>
<span id="cb129-149"><a href="function-approximation-and-feature-engineering.html#cb129-149" tabindex="-1"></a>          <span class="at">data =</span> all_rects,</span>
<span id="cb129-150"><a href="function-approximation-and-feature-engineering.html#cb129-150" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax, <span class="at">ymin =</span> ymin, <span class="at">ymax =</span> ymax),</span>
<span id="cb129-151"><a href="function-approximation-and-feature-engineering.html#cb129-151" tabindex="-1"></a>          <span class="at">fill =</span> colors[all_rects<span class="sc">$</span>tiling],</span>
<span id="cb129-152"><a href="function-approximation-and-feature-engineering.html#cb129-152" tabindex="-1"></a>          <span class="at">alpha =</span> <span class="fl">0.4</span>,</span>
<span id="cb129-153"><a href="function-approximation-and-feature-engineering.html#cb129-153" tabindex="-1"></a>          <span class="at">color =</span> colors[all_rects<span class="sc">$</span>tiling],</span>
<span id="cb129-154"><a href="function-approximation-and-feature-engineering.html#cb129-154" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">1.2</span></span>
<span id="cb129-155"><a href="function-approximation-and-feature-engineering.html#cb129-155" tabindex="-1"></a>        )</span>
<span id="cb129-156"><a href="function-approximation-and-feature-engineering.html#cb129-156" tabindex="-1"></a>      }</span>
<span id="cb129-157"><a href="function-approximation-and-feature-engineering.html#cb129-157" tabindex="-1"></a>      </span>
<span id="cb129-158"><a href="function-approximation-and-feature-engineering.html#cb129-158" tabindex="-1"></a>      <span class="co"># Mark query state</span></span>
<span id="cb129-159"><a href="function-approximation-and-feature-engineering.html#cb129-159" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">geom_point</span>(</span>
<span id="cb129-160"><a href="function-approximation-and-feature-engineering.html#cb129-160" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> query_state[<span class="dv">1</span>], <span class="at">y =</span> query_state[<span class="dv">2</span>]), </span>
<span id="cb129-161"><a href="function-approximation-and-feature-engineering.html#cb129-161" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">shape =</span> <span class="dv">17</span></span>
<span id="cb129-162"><a href="function-approximation-and-feature-engineering.html#cb129-162" tabindex="-1"></a>      )</span>
<span id="cb129-163"><a href="function-approximation-and-feature-engineering.html#cb129-163" tabindex="-1"></a>      </span>
<span id="cb129-164"><a href="function-approximation-and-feature-engineering.html#cb129-164" tabindex="-1"></a>      subtitle <span class="ot">&lt;-</span> <span class="fu">paste</span>(num_tilings, <span class="st">&quot;active tiles (one per tiling)&quot;</span>)</span>
<span id="cb129-165"><a href="function-approximation-and-feature-engineering.html#cb129-165" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb129-166"><a href="function-approximation-and-feature-engineering.html#cb129-166" tabindex="-1"></a>      subtitle <span class="ot">&lt;-</span> <span class="fu">paste</span>(num_tilings, <span class="st">&quot;overlapping tilings&quot;</span>)</span>
<span id="cb129-167"><a href="function-approximation-and-feature-engineering.html#cb129-167" tabindex="-1"></a>    }</span>
<span id="cb129-168"><a href="function-approximation-and-feature-engineering.html#cb129-168" tabindex="-1"></a>    </span>
<span id="cb129-169"><a href="function-approximation-and-feature-engineering.html#cb129-169" tabindex="-1"></a>    p <span class="sc">+</span> <span class="fu">labs</span>(</span>
<span id="cb129-170"><a href="function-approximation-and-feature-engineering.html#cb129-170" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&quot;Tile Coding&quot;</span>,</span>
<span id="cb129-171"><a href="function-approximation-and-feature-engineering.html#cb129-171" tabindex="-1"></a>      <span class="at">subtitle =</span> subtitle,</span>
<span id="cb129-172"><a href="function-approximation-and-feature-engineering.html#cb129-172" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">&quot;State Dimension 1&quot;</span>,</span>
<span id="cb129-173"><a href="function-approximation-and-feature-engineering.html#cb129-173" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&quot;State Dimension 2&quot;</span></span>
<span id="cb129-174"><a href="function-approximation-and-feature-engineering.html#cb129-174" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb129-175"><a href="function-approximation-and-feature-engineering.html#cb129-175" tabindex="-1"></a>      <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb129-176"><a href="function-approximation-and-feature-engineering.html#cb129-176" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb129-177"><a href="function-approximation-and-feature-engineering.html#cb129-177" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb129-178"><a href="function-approximation-and-feature-engineering.html#cb129-178" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb129-179"><a href="function-approximation-and-feature-engineering.html#cb129-179" tabindex="-1"></a>      )</span>
<span id="cb129-180"><a href="function-approximation-and-feature-engineering.html#cb129-180" tabindex="-1"></a>  }</span>
<span id="cb129-181"><a href="function-approximation-and-feature-engineering.html#cb129-181" tabindex="-1"></a>  </span>
<span id="cb129-182"><a href="function-approximation-and-feature-engineering.html#cb129-182" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb129-183"><a href="function-approximation-and-feature-engineering.html#cb129-183" tabindex="-1"></a>    <span class="at">encode =</span> encode,</span>
<span id="cb129-184"><a href="function-approximation-and-feature-engineering.html#cb129-184" tabindex="-1"></a>    <span class="at">visualize =</span> visualize,</span>
<span id="cb129-185"><a href="function-approximation-and-feature-engineering.html#cb129-185" tabindex="-1"></a>    <span class="at">state_low =</span> state_low,</span>
<span id="cb129-186"><a href="function-approximation-and-feature-engineering.html#cb129-186" tabindex="-1"></a>    <span class="at">state_high =</span> state_high,</span>
<span id="cb129-187"><a href="function-approximation-and-feature-engineering.html#cb129-187" tabindex="-1"></a>    <span class="at">num_tilings =</span> num_tilings,</span>
<span id="cb129-188"><a href="function-approximation-and-feature-engineering.html#cb129-188" tabindex="-1"></a>    <span class="at">tiles_per_dim =</span> tiles_per_dim,</span>
<span id="cb129-189"><a href="function-approximation-and-feature-engineering.html#cb129-189" tabindex="-1"></a>    <span class="at">tile_widths =</span> tile_widths,</span>
<span id="cb129-190"><a href="function-approximation-and-feature-engineering.html#cb129-190" tabindex="-1"></a>    <span class="at">offsets =</span> offsets</span>
<span id="cb129-191"><a href="function-approximation-and-feature-engineering.html#cb129-191" tabindex="-1"></a>  ))</span>
<span id="cb129-192"><a href="function-approximation-and-feature-engineering.html#cb129-192" tabindex="-1"></a>}</span>
<span id="cb129-193"><a href="function-approximation-and-feature-engineering.html#cb129-193" tabindex="-1"></a></span>
<span id="cb129-194"><a href="function-approximation-and-feature-engineering.html#cb129-194" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb129-195"><a href="function-approximation-and-feature-engineering.html#cb129-195" tabindex="-1"></a>tile_coder <span class="ot">&lt;-</span> <span class="fu">create_tile_coder</span>(</span>
<span id="cb129-196"><a href="function-approximation-and-feature-engineering.html#cb129-196" tabindex="-1"></a>  <span class="at">state_low =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb129-197"><a href="function-approximation-and-feature-engineering.html#cb129-197" tabindex="-1"></a>  <span class="at">state_high =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>),</span>
<span id="cb129-198"><a href="function-approximation-and-feature-engineering.html#cb129-198" tabindex="-1"></a>  <span class="at">num_tilings =</span> <span class="dv">4</span>,</span>
<span id="cb129-199"><a href="function-approximation-and-feature-engineering.html#cb129-199" tabindex="-1"></a>  <span class="at">tiles_per_dim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb129-200"><a href="function-approximation-and-feature-engineering.html#cb129-200" tabindex="-1"></a>)</span>
<span id="cb129-201"><a href="function-approximation-and-feature-engineering.html#cb129-201" tabindex="-1"></a></span>
<span id="cb129-202"><a href="function-approximation-and-feature-engineering.html#cb129-202" tabindex="-1"></a><span class="co"># Visualize with query state</span></span>
<span id="cb129-203"><a href="function-approximation-and-feature-engineering.html#cb129-203" tabindex="-1"></a><span class="fu">print</span>(tile_coder<span class="sc">$</span><span class="fu">visualize</span>(<span class="at">query_state =</span> <span class="fu">c</span>(<span class="fl">3.2</span>, <span class="fl">7.8</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="radial-basis-functions-smooth-continuous-features" class="section level3 hasAnchor" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> Radial Basis Functions: Smooth Continuous Features<a href="function-approximation-and-feature-engineering.html#radial-basis-functions-smooth-continuous-features" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Radial Basis Functions represent a fundamentally different approach to feature construction. Instead of binary activations, RBFs provide smooth, continuous responses that depend on the distance from fixed center points. The most common form uses Gaussian functions:</p>
<p>Ï_i(s) = exp(-||s - c_i||^2 / (2Ï_i^2))</p>
<p>Here c_i represents the center of the i-th RBF, while Ï_i controls its width or bandwidth. Unlike the sharp boundaries of tile coding or coarse coding, RBFs create smooth activation landscapes that vary continuously with state changes. This smoothness often produces more stable learning dynamics and can lead to better generalization in certain domains.</p>
<p>The width parameter Ï plays a crucial role in controlling the locality of influence. Narrow RBFs (small Ï) create peaked functions that provide high discrimination but limited generalization. Wide RBFs (large Ï) create broad functions that generalize extensively but may lack the discrimination needed for complex tasks. The optimal choice depends on the smoothness of the target function and the density of training data.</p>
<p>RBF networks possess powerful theoretical properties. They are universal approximators, meaning they can represent any continuous function to arbitrary accuracy given sufficient basis functions. The placement of centers and selection of widths determine the networkâs effectiveness. Centers can be positioned on regular grids, placed randomly, or adapted during learning using techniques like k-means clustering on experienced states.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="function-approximation-and-feature-engineering.html#cb130-1" tabindex="-1"></a><span class="co"># Load additional libraries for RBF network</span></span>
<span id="cb130-2"><a href="function-approximation-and-feature-engineering.html#cb130-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb130-3"><a href="function-approximation-and-feature-engineering.html#cb130-3" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb130-4"><a href="function-approximation-and-feature-engineering.html#cb130-4" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb130-5"><a href="function-approximation-and-feature-engineering.html#cb130-5" tabindex="-1"></a></span>
<span id="cb130-6"><a href="function-approximation-and-feature-engineering.html#cb130-6" tabindex="-1"></a><span class="co"># Radial Basis Function Network Implementation</span></span>
<span id="cb130-7"><a href="function-approximation-and-feature-engineering.html#cb130-7" tabindex="-1"></a>create_rbf_network <span class="ot">&lt;-</span> <span class="cf">function</span>(centers, widths) {</span>
<span id="cb130-8"><a href="function-approximation-and-feature-engineering.html#cb130-8" tabindex="-1"></a>  <span class="co"># Convert centers to matrix format</span></span>
<span id="cb130-9"><a href="function-approximation-and-feature-engineering.html#cb130-9" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.data.frame</span>(centers)) {</span>
<span id="cb130-10"><a href="function-approximation-and-feature-engineering.html#cb130-10" tabindex="-1"></a>    centers <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(centers)</span>
<span id="cb130-11"><a href="function-approximation-and-feature-engineering.html#cb130-11" tabindex="-1"></a>  }</span>
<span id="cb130-12"><a href="function-approximation-and-feature-engineering.html#cb130-12" tabindex="-1"></a>  </span>
<span id="cb130-13"><a href="function-approximation-and-feature-engineering.html#cb130-13" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.matrix</span>(centers) <span class="sc">||</span> <span class="fu">ncol</span>(centers) <span class="sc">!=</span> <span class="dv">2</span>) {</span>
<span id="cb130-14"><a href="function-approximation-and-feature-engineering.html#cb130-14" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;centers must be a 2-column matrix or data frame&quot;</span>)</span>
<span id="cb130-15"><a href="function-approximation-and-feature-engineering.html#cb130-15" tabindex="-1"></a>  }</span>
<span id="cb130-16"><a href="function-approximation-and-feature-engineering.html#cb130-16" tabindex="-1"></a>  </span>
<span id="cb130-17"><a href="function-approximation-and-feature-engineering.html#cb130-17" tabindex="-1"></a>  n_rbf <span class="ot">&lt;-</span> <span class="fu">nrow</span>(centers)</span>
<span id="cb130-18"><a href="function-approximation-and-feature-engineering.html#cb130-18" tabindex="-1"></a>  </span>
<span id="cb130-19"><a href="function-approximation-and-feature-engineering.html#cb130-19" tabindex="-1"></a>  <span class="co"># Handle scalar or vector widths</span></span>
<span id="cb130-20"><a href="function-approximation-and-feature-engineering.html#cb130-20" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(widths) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb130-21"><a href="function-approximation-and-feature-engineering.html#cb130-21" tabindex="-1"></a>    widths <span class="ot">&lt;-</span> <span class="fu">rep</span>(widths, n_rbf)</span>
<span id="cb130-22"><a href="function-approximation-and-feature-engineering.html#cb130-22" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">length</span>(widths) <span class="sc">!=</span> n_rbf) {</span>
<span id="cb130-23"><a href="function-approximation-and-feature-engineering.html#cb130-23" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;length of widths must be 1 or equal to number of centers&quot;</span>)</span>
<span id="cb130-24"><a href="function-approximation-and-feature-engineering.html#cb130-24" tabindex="-1"></a>  }</span>
<span id="cb130-25"><a href="function-approximation-and-feature-engineering.html#cb130-25" tabindex="-1"></a>  </span>
<span id="cb130-26"><a href="function-approximation-and-feature-engineering.html#cb130-26" tabindex="-1"></a>  <span class="co"># Function to compute RBF activations for given state</span></span>
<span id="cb130-27"><a href="function-approximation-and-feature-engineering.html#cb130-27" tabindex="-1"></a>  encode <span class="ot">&lt;-</span> <span class="cf">function</span>(state) {</span>
<span id="cb130-28"><a href="function-approximation-and-feature-engineering.html#cb130-28" tabindex="-1"></a>    state_vec <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(state)</span>
<span id="cb130-29"><a href="function-approximation-and-feature-engineering.html#cb130-29" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(state_vec) <span class="sc">!=</span> <span class="dv">2</span>) {</span>
<span id="cb130-30"><a href="function-approximation-and-feature-engineering.html#cb130-30" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;State must be 2-dimensional for current implementation&quot;</span>)</span>
<span id="cb130-31"><a href="function-approximation-and-feature-engineering.html#cb130-31" tabindex="-1"></a>    }</span>
<span id="cb130-32"><a href="function-approximation-and-feature-engineering.html#cb130-32" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.finite</span>(state_vec))) {</span>
<span id="cb130-33"><a href="function-approximation-and-feature-engineering.html#cb130-33" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;State contains non-finite values&quot;</span>)</span>
<span id="cb130-34"><a href="function-approximation-and-feature-engineering.html#cb130-34" tabindex="-1"></a>    }</span>
<span id="cb130-35"><a href="function-approximation-and-feature-engineering.html#cb130-35" tabindex="-1"></a>    state_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(state_vec, n_rbf), <span class="at">nrow =</span> n_rbf, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb130-36"><a href="function-approximation-and-feature-engineering.html#cb130-36" tabindex="-1"></a>    distances_sq <span class="ot">&lt;-</span> <span class="fu">rowSums</span>((centers <span class="sc">-</span> state_mat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb130-37"><a href="function-approximation-and-feature-engineering.html#cb130-37" tabindex="-1"></a>    activations <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>distances_sq <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> widths<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb130-38"><a href="function-approximation-and-feature-engineering.html#cb130-38" tabindex="-1"></a>    <span class="fu">return</span>(activations)</span>
<span id="cb130-39"><a href="function-approximation-and-feature-engineering.html#cb130-39" tabindex="-1"></a>  }</span>
<span id="cb130-40"><a href="function-approximation-and-feature-engineering.html#cb130-40" tabindex="-1"></a>  </span>
<span id="cb130-41"><a href="function-approximation-and-feature-engineering.html#cb130-41" tabindex="-1"></a>  <span class="co"># Function to create adaptive RBF centers using k-means-like placement</span></span>
<span id="cb130-42"><a href="function-approximation-and-feature-engineering.html#cb130-42" tabindex="-1"></a>  create_adaptive_centers <span class="ot">&lt;-</span> <span class="cf">function</span>(state_dims, n_centers, <span class="at">n_samples =</span> <span class="dv">1000</span>, <span class="at">seed =</span> <span class="dv">42</span>) {</span>
<span id="cb130-43"><a href="function-approximation-and-feature-engineering.html#cb130-43" tabindex="-1"></a>    <span class="fu">set.seed</span>(seed)</span>
<span id="cb130-44"><a href="function-approximation-and-feature-engineering.html#cb130-44" tabindex="-1"></a>    </span>
<span id="cb130-45"><a href="function-approximation-and-feature-engineering.html#cb130-45" tabindex="-1"></a>    <span class="co"># Generate random samples from state space [0, state_dims[1]] x [0, state_dims[2]]</span></span>
<span id="cb130-46"><a href="function-approximation-and-feature-engineering.html#cb130-46" tabindex="-1"></a>    samples <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb130-47"><a href="function-approximation-and-feature-engineering.html#cb130-47" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">runif</span>(n_samples, <span class="dv">0</span>, state_dims[<span class="dv">1</span>]),</span>
<span id="cb130-48"><a href="function-approximation-and-feature-engineering.html#cb130-48" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">runif</span>(n_samples, <span class="dv">0</span>, state_dims[<span class="dv">2</span>])</span>
<span id="cb130-49"><a href="function-approximation-and-feature-engineering.html#cb130-49" tabindex="-1"></a>    )</span>
<span id="cb130-50"><a href="function-approximation-and-feature-engineering.html#cb130-50" tabindex="-1"></a>    </span>
<span id="cb130-51"><a href="function-approximation-and-feature-engineering.html#cb130-51" tabindex="-1"></a>    <span class="co"># Initialize centers randomly</span></span>
<span id="cb130-52"><a href="function-approximation-and-feature-engineering.html#cb130-52" tabindex="-1"></a>    centers_df <span class="ot">&lt;-</span> samples[<span class="fu">sample</span>(<span class="fu">nrow</span>(samples), n_centers), , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb130-53"><a href="function-approximation-and-feature-engineering.html#cb130-53" tabindex="-1"></a>    centers_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(centers_df)</span>
<span id="cb130-54"><a href="function-approximation-and-feature-engineering.html#cb130-54" tabindex="-1"></a>    </span>
<span id="cb130-55"><a href="function-approximation-and-feature-engineering.html#cb130-55" tabindex="-1"></a>    <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>) {</span>
<span id="cb130-56"><a href="function-approximation-and-feature-engineering.html#cb130-56" tabindex="-1"></a>      <span class="co"># Compute distances from all samples to all centers</span></span>
<span id="cb130-57"><a href="function-approximation-and-feature-engineering.html#cb130-57" tabindex="-1"></a>      <span class="co"># Efficient vectorized approach</span></span>
<span id="cb130-58"><a href="function-approximation-and-feature-engineering.html#cb130-58" tabindex="-1"></a>      dists <span class="ot">&lt;-</span> <span class="fu">outer</span>(samples<span class="sc">$</span>x, centers_mat[,<span class="dv">1</span>], <span class="at">FUN =</span> <span class="cf">function</span>(a,b) (a <span class="sc">-</span> b)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb130-59"><a href="function-approximation-and-feature-engineering.html#cb130-59" tabindex="-1"></a>               <span class="fu">outer</span>(samples<span class="sc">$</span>y, centers_mat[,<span class="dv">2</span>], <span class="at">FUN =</span> <span class="cf">function</span>(a,b) (a <span class="sc">-</span> b)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb130-60"><a href="function-approximation-and-feature-engineering.html#cb130-60" tabindex="-1"></a>      assignments <span class="ot">&lt;-</span> <span class="fu">max.col</span>(<span class="sc">-</span>dists)  <span class="co"># equivalent to which.min per row</span></span>
<span id="cb130-61"><a href="function-approximation-and-feature-engineering.html#cb130-61" tabindex="-1"></a>      </span>
<span id="cb130-62"><a href="function-approximation-and-feature-engineering.html#cb130-62" tabindex="-1"></a>      <span class="co"># Update centers</span></span>
<span id="cb130-63"><a href="function-approximation-and-feature-engineering.html#cb130-63" tabindex="-1"></a>      new_centers <span class="ot">&lt;-</span> centers_mat</span>
<span id="cb130-64"><a href="function-approximation-and-feature-engineering.html#cb130-64" tabindex="-1"></a>      <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_centers) {</span>
<span id="cb130-65"><a href="function-approximation-and-feature-engineering.html#cb130-65" tabindex="-1"></a>        idx <span class="ot">&lt;-</span> <span class="fu">which</span>(assignments <span class="sc">==</span> k)</span>
<span id="cb130-66"><a href="function-approximation-and-feature-engineering.html#cb130-66" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">length</span>(idx) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb130-67"><a href="function-approximation-and-feature-engineering.html#cb130-67" tabindex="-1"></a>          new_centers[k, ] <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(samples[idx, , <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb130-68"><a href="function-approximation-and-feature-engineering.html#cb130-68" tabindex="-1"></a>        }</span>
<span id="cb130-69"><a href="function-approximation-and-feature-engineering.html#cb130-69" tabindex="-1"></a>      }</span>
<span id="cb130-70"><a href="function-approximation-and-feature-engineering.html#cb130-70" tabindex="-1"></a>      </span>
<span id="cb130-71"><a href="function-approximation-and-feature-engineering.html#cb130-71" tabindex="-1"></a>      <span class="co"># Check convergence</span></span>
<span id="cb130-72"><a href="function-approximation-and-feature-engineering.html#cb130-72" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">sum</span>((new_centers <span class="sc">-</span> centers_mat)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">&lt;</span> <span class="fl">1e-6</span>) <span class="cf">break</span></span>
<span id="cb130-73"><a href="function-approximation-and-feature-engineering.html#cb130-73" tabindex="-1"></a>      centers_mat <span class="ot">&lt;-</span> new_centers</span>
<span id="cb130-74"><a href="function-approximation-and-feature-engineering.html#cb130-74" tabindex="-1"></a>    }</span>
<span id="cb130-75"><a href="function-approximation-and-feature-engineering.html#cb130-75" tabindex="-1"></a>    </span>
<span id="cb130-76"><a href="function-approximation-and-feature-engineering.html#cb130-76" tabindex="-1"></a>    <span class="fu">return</span>(centers_mat)</span>
<span id="cb130-77"><a href="function-approximation-and-feature-engineering.html#cb130-77" tabindex="-1"></a>  }</span>
<span id="cb130-78"><a href="function-approximation-and-feature-engineering.html#cb130-78" tabindex="-1"></a>  </span>
<span id="cb130-79"><a href="function-approximation-and-feature-engineering.html#cb130-79" tabindex="-1"></a>  <span class="co"># Visualization function for activation landscape</span></span>
<span id="cb130-80"><a href="function-approximation-and-feature-engineering.html#cb130-80" tabindex="-1"></a>  visualize_activation_landscape <span class="ot">&lt;-</span> <span class="cf">function</span>(state_dims, <span class="at">resolution =</span> <span class="dv">100</span>) {</span>
<span id="cb130-81"><a href="function-approximation-and-feature-engineering.html#cb130-81" tabindex="-1"></a>    <span class="co"># Create evaluation grid</span></span>
<span id="cb130-82"><a href="function-approximation-and-feature-engineering.html#cb130-82" tabindex="-1"></a>    x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, state_dims[<span class="dv">1</span>], <span class="at">length.out =</span> resolution)</span>
<span id="cb130-83"><a href="function-approximation-and-feature-engineering.html#cb130-83" tabindex="-1"></a>    y_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, state_dims[<span class="dv">2</span>], <span class="at">length.out =</span> resolution)</span>
<span id="cb130-84"><a href="function-approximation-and-feature-engineering.html#cb130-84" tabindex="-1"></a>    grid_df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x =</span> x_seq, <span class="at">y =</span> y_seq)</span>
<span id="cb130-85"><a href="function-approximation-and-feature-engineering.html#cb130-85" tabindex="-1"></a>    </span>
<span id="cb130-86"><a href="function-approximation-and-feature-engineering.html#cb130-86" tabindex="-1"></a>    <span class="co"># Compute total activation at each point</span></span>
<span id="cb130-87"><a href="function-approximation-and-feature-engineering.html#cb130-87" tabindex="-1"></a>    grid_df<span class="sc">$</span>activation <span class="ot">&lt;-</span> <span class="fu">apply</span>(grid_df, <span class="dv">1</span>, <span class="cf">function</span>(point) {</span>
<span id="cb130-88"><a href="function-approximation-and-feature-engineering.html#cb130-88" tabindex="-1"></a>      <span class="fu">sum</span>(<span class="fu">encode</span>(point))</span>
<span id="cb130-89"><a href="function-approximation-and-feature-engineering.html#cb130-89" tabindex="-1"></a>    })</span>
<span id="cb130-90"><a href="function-approximation-and-feature-engineering.html#cb130-90" tabindex="-1"></a>    </span>
<span id="cb130-91"><a href="function-approximation-and-feature-engineering.html#cb130-91" tabindex="-1"></a>    <span class="co"># Prepare center data frame with explicit column names</span></span>
<span id="cb130-92"><a href="function-approximation-and-feature-engineering.html#cb130-92" tabindex="-1"></a>    center_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb130-93"><a href="function-approximation-and-feature-engineering.html#cb130-93" tabindex="-1"></a>      <span class="at">x =</span> centers[, <span class="dv">1</span>],</span>
<span id="cb130-94"><a href="function-approximation-and-feature-engineering.html#cb130-94" tabindex="-1"></a>      <span class="at">y =</span> centers[, <span class="dv">2</span>]</span>
<span id="cb130-95"><a href="function-approximation-and-feature-engineering.html#cb130-95" tabindex="-1"></a>    )</span>
<span id="cb130-96"><a href="function-approximation-and-feature-engineering.html#cb130-96" tabindex="-1"></a>    </span>
<span id="cb130-97"><a href="function-approximation-and-feature-engineering.html#cb130-97" tabindex="-1"></a>    <span class="co"># Create visualization</span></span>
<span id="cb130-98"><a href="function-approximation-and-feature-engineering.html#cb130-98" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(grid_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> activation)) <span class="sc">+</span></span>
<span id="cb130-99"><a href="function-approximation-and-feature-engineering.html#cb130-99" tabindex="-1"></a>      <span class="fu">geom_raster</span>(<span class="at">interpolate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb130-100"><a href="function-approximation-and-feature-engineering.html#cb130-100" tabindex="-1"></a>      <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">z =</span> activation), <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">size =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb130-101"><a href="function-approximation-and-feature-engineering.html#cb130-101" tabindex="-1"></a>      <span class="fu">geom_point</span>(</span>
<span id="cb130-102"><a href="function-approximation-and-feature-engineering.html#cb130-102" tabindex="-1"></a>        <span class="at">data =</span> center_df, </span>
<span id="cb130-103"><a href="function-approximation-and-feature-engineering.html#cb130-103" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), </span>
<span id="cb130-104"><a href="function-approximation-and-feature-engineering.html#cb130-104" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">stroke =</span> <span class="fl">1.5</span>,</span>
<span id="cb130-105"><a href="function-approximation-and-feature-engineering.html#cb130-105" tabindex="-1"></a>        <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb130-106"><a href="function-approximation-and-feature-engineering.html#cb130-106" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb130-107"><a href="function-approximation-and-feature-engineering.html#cb130-107" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">&quot;Total</span><span class="sc">\n</span><span class="st">Activation&quot;</span>, <span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>) <span class="sc">+</span></span>
<span id="cb130-108"><a href="function-approximation-and-feature-engineering.html#cb130-108" tabindex="-1"></a>      <span class="fu">coord_fixed</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, state_dims[<span class="dv">1</span>]), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, state_dims[<span class="dv">2</span>]), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb130-109"><a href="function-approximation-and-feature-engineering.html#cb130-109" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb130-110"><a href="function-approximation-and-feature-engineering.html#cb130-110" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;RBF Network: Combined Activation Landscape&quot;</span>,</span>
<span id="cb130-111"><a href="function-approximation-and-feature-engineering.html#cb130-111" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;White crosses indicate&quot;</span>, n_rbf, <span class="st">&quot;RBF centers&quot;</span>),</span>
<span id="cb130-112"><a href="function-approximation-and-feature-engineering.html#cb130-112" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;State Dimension 1&quot;</span>,</span>
<span id="cb130-113"><a href="function-approximation-and-feature-engineering.html#cb130-113" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;State Dimension 2&quot;</span></span>
<span id="cb130-114"><a href="function-approximation-and-feature-engineering.html#cb130-114" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb130-115"><a href="function-approximation-and-feature-engineering.html#cb130-115" tabindex="-1"></a>      <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb130-116"><a href="function-approximation-and-feature-engineering.html#cb130-116" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb130-117"><a href="function-approximation-and-feature-engineering.html#cb130-117" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb130-118"><a href="function-approximation-and-feature-engineering.html#cb130-118" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>)</span>
<span id="cb130-119"><a href="function-approximation-and-feature-engineering.html#cb130-119" tabindex="-1"></a>      )</span>
<span id="cb130-120"><a href="function-approximation-and-feature-engineering.html#cb130-120" tabindex="-1"></a>    </span>
<span id="cb130-121"><a href="function-approximation-and-feature-engineering.html#cb130-121" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb130-122"><a href="function-approximation-and-feature-engineering.html#cb130-122" tabindex="-1"></a>  }</span>
<span id="cb130-123"><a href="function-approximation-and-feature-engineering.html#cb130-123" tabindex="-1"></a>  </span>
<span id="cb130-124"><a href="function-approximation-and-feature-engineering.html#cb130-124" tabindex="-1"></a>  <span class="co"># Visualization function for individual RBFs</span></span>
<span id="cb130-125"><a href="function-approximation-and-feature-engineering.html#cb130-125" tabindex="-1"></a>  visualize_individual_rbfs <span class="ot">&lt;-</span> <span class="cf">function</span>(state_dims, <span class="at">resolution =</span> <span class="dv">50</span>) {</span>
<span id="cb130-126"><a href="function-approximation-and-feature-engineering.html#cb130-126" tabindex="-1"></a>    <span class="co"># Determine subplot layout</span></span>
<span id="cb130-127"><a href="function-approximation-and-feature-engineering.html#cb130-127" tabindex="-1"></a>    n_cols <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(n_rbf))</span>
<span id="cb130-128"><a href="function-approximation-and-feature-engineering.html#cb130-128" tabindex="-1"></a>    n_rows <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(n_rbf <span class="sc">/</span> n_cols)</span>
<span id="cb130-129"><a href="function-approximation-and-feature-engineering.html#cb130-129" tabindex="-1"></a>    </span>
<span id="cb130-130"><a href="function-approximation-and-feature-engineering.html#cb130-130" tabindex="-1"></a>    <span class="co"># Create evaluation grid</span></span>
<span id="cb130-131"><a href="function-approximation-and-feature-engineering.html#cb130-131" tabindex="-1"></a>    x_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, state_dims[<span class="dv">1</span>], <span class="at">length.out =</span> resolution)</span>
<span id="cb130-132"><a href="function-approximation-and-feature-engineering.html#cb130-132" tabindex="-1"></a>    y_seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, state_dims[<span class="dv">2</span>], <span class="at">length.out =</span> resolution)</span>
<span id="cb130-133"><a href="function-approximation-and-feature-engineering.html#cb130-133" tabindex="-1"></a>    grid_df <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x =</span> x_seq, <span class="at">y =</span> y_seq)</span>
<span id="cb130-134"><a href="function-approximation-and-feature-engineering.html#cb130-134" tabindex="-1"></a>    </span>
<span id="cb130-135"><a href="function-approximation-and-feature-engineering.html#cb130-135" tabindex="-1"></a>    <span class="co"># Prepare data for all RBFs</span></span>
<span id="cb130-136"><a href="function-approximation-and-feature-engineering.html#cb130-136" tabindex="-1"></a>    all_rbf_data <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, n_rbf)</span>
<span id="cb130-137"><a href="function-approximation-and-feature-engineering.html#cb130-137" tabindex="-1"></a>    </span>
<span id="cb130-138"><a href="function-approximation-and-feature-engineering.html#cb130-138" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_rbf) {</span>
<span id="cb130-139"><a href="function-approximation-and-feature-engineering.html#cb130-139" tabindex="-1"></a>      <span class="co"># Compute activation for this RBF only</span></span>
<span id="cb130-140"><a href="function-approximation-and-feature-engineering.html#cb130-140" tabindex="-1"></a>      state_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(centers[i, ], <span class="fu">nrow</span>(grid_df)), <span class="at">nrow =</span> <span class="fu">nrow</span>(grid_df), <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb130-141"><a href="function-approximation-and-feature-engineering.html#cb130-141" tabindex="-1"></a>      distances_sq <span class="ot">&lt;-</span> <span class="fu">rowSums</span>((grid_df <span class="sc">-</span> state_mat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb130-142"><a href="function-approximation-and-feature-engineering.html#cb130-142" tabindex="-1"></a>      activations <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>distances_sq <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> widths[i]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb130-143"><a href="function-approximation-and-feature-engineering.html#cb130-143" tabindex="-1"></a>      </span>
<span id="cb130-144"><a href="function-approximation-and-feature-engineering.html#cb130-144" tabindex="-1"></a>      rbf_data <span class="ot">&lt;-</span> grid_df</span>
<span id="cb130-145"><a href="function-approximation-and-feature-engineering.html#cb130-145" tabindex="-1"></a>      rbf_data<span class="sc">$</span>activation <span class="ot">&lt;-</span> activations</span>
<span id="cb130-146"><a href="function-approximation-and-feature-engineering.html#cb130-146" tabindex="-1"></a>      rbf_data<span class="sc">$</span>rbf_id <span class="ot">&lt;-</span> i</span>
<span id="cb130-147"><a href="function-approximation-and-feature-engineering.html#cb130-147" tabindex="-1"></a>      rbf_data<span class="sc">$</span>rbf_label <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;RBF &quot;</span>, i, <span class="st">&quot; (Ï=&quot;</span>, <span class="fu">round</span>(widths[i], <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>)</span>
<span id="cb130-148"><a href="function-approximation-and-feature-engineering.html#cb130-148" tabindex="-1"></a>      </span>
<span id="cb130-149"><a href="function-approximation-and-feature-engineering.html#cb130-149" tabindex="-1"></a>      all_rbf_data[[i]] <span class="ot">&lt;-</span> rbf_data</span>
<span id="cb130-150"><a href="function-approximation-and-feature-engineering.html#cb130-150" tabindex="-1"></a>    }</span>
<span id="cb130-151"><a href="function-approximation-and-feature-engineering.html#cb130-151" tabindex="-1"></a>    </span>
<span id="cb130-152"><a href="function-approximation-and-feature-engineering.html#cb130-152" tabindex="-1"></a>    <span class="co"># Combine all data</span></span>
<span id="cb130-153"><a href="function-approximation-and-feature-engineering.html#cb130-153" tabindex="-1"></a>    combined_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, all_rbf_data)</span>
<span id="cb130-154"><a href="function-approximation-and-feature-engineering.html#cb130-154" tabindex="-1"></a>    </span>
<span id="cb130-155"><a href="function-approximation-and-feature-engineering.html#cb130-155" tabindex="-1"></a>    <span class="co"># Add center information with named columns</span></span>
<span id="cb130-156"><a href="function-approximation-and-feature-engineering.html#cb130-156" tabindex="-1"></a>    center_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb130-157"><a href="function-approximation-and-feature-engineering.html#cb130-157" tabindex="-1"></a>      <span class="at">x =</span> centers[, <span class="dv">1</span>],</span>
<span id="cb130-158"><a href="function-approximation-and-feature-engineering.html#cb130-158" tabindex="-1"></a>      <span class="at">y =</span> centers[, <span class="dv">2</span>],</span>
<span id="cb130-159"><a href="function-approximation-and-feature-engineering.html#cb130-159" tabindex="-1"></a>      <span class="at">rbf_id =</span> <span class="dv">1</span><span class="sc">:</span>n_rbf,</span>
<span id="cb130-160"><a href="function-approximation-and-feature-engineering.html#cb130-160" tabindex="-1"></a>      <span class="at">rbf_label =</span> <span class="fu">paste0</span>(<span class="st">&quot;RBF &quot;</span>, <span class="dv">1</span><span class="sc">:</span>n_rbf, <span class="st">&quot; (Ï=&quot;</span>, <span class="fu">round</span>(widths, <span class="dv">1</span>), <span class="st">&quot;)&quot;</span>)</span>
<span id="cb130-161"><a href="function-approximation-and-feature-engineering.html#cb130-161" tabindex="-1"></a>    )</span>
<span id="cb130-162"><a href="function-approximation-and-feature-engineering.html#cb130-162" tabindex="-1"></a>    </span>
<span id="cb130-163"><a href="function-approximation-and-feature-engineering.html#cb130-163" tabindex="-1"></a>    <span class="co"># Create faceted plot</span></span>
<span id="cb130-164"><a href="function-approximation-and-feature-engineering.html#cb130-164" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> activation)) <span class="sc">+</span></span>
<span id="cb130-165"><a href="function-approximation-and-feature-engineering.html#cb130-165" tabindex="-1"></a>      <span class="fu">geom_raster</span>(<span class="at">interpolate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb130-166"><a href="function-approximation-and-feature-engineering.html#cb130-166" tabindex="-1"></a>      <span class="fu">geom_point</span>(</span>
<span id="cb130-167"><a href="function-approximation-and-feature-engineering.html#cb130-167" tabindex="-1"></a>        <span class="at">data =</span> center_data,</span>
<span id="cb130-168"><a href="function-approximation-and-feature-engineering.html#cb130-168" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y),</span>
<span id="cb130-169"><a href="function-approximation-and-feature-engineering.html#cb130-169" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">4</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">stroke =</span> <span class="dv">1</span>,</span>
<span id="cb130-170"><a href="function-approximation-and-feature-engineering.html#cb130-170" tabindex="-1"></a>        <span class="at">inherit.aes =</span> <span class="cn">FALSE</span></span>
<span id="cb130-171"><a href="function-approximation-and-feature-engineering.html#cb130-171" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb130-172"><a href="function-approximation-and-feature-engineering.html#cb130-172" tabindex="-1"></a>      <span class="fu">facet_wrap</span>(<span class="sc">~</span> rbf_label, <span class="at">ncol =</span> n_cols) <span class="sc">+</span></span>
<span id="cb130-173"><a href="function-approximation-and-feature-engineering.html#cb130-173" tabindex="-1"></a>      <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">name =</span> <span class="st">&quot;Activation&quot;</span>) <span class="sc">+</span></span>
<span id="cb130-174"><a href="function-approximation-and-feature-engineering.html#cb130-174" tabindex="-1"></a>      <span class="fu">coord_fixed</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb130-175"><a href="function-approximation-and-feature-engineering.html#cb130-175" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb130-176"><a href="function-approximation-and-feature-engineering.html#cb130-176" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">&quot;Individual RBF Activations&quot;</span>,</span>
<span id="cb130-177"><a href="function-approximation-and-feature-engineering.html#cb130-177" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;State Dimension 1&quot;</span>,</span>
<span id="cb130-178"><a href="function-approximation-and-feature-engineering.html#cb130-178" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;State Dimension 2&quot;</span></span>
<span id="cb130-179"><a href="function-approximation-and-feature-engineering.html#cb130-179" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb130-180"><a href="function-approximation-and-feature-engineering.html#cb130-180" tabindex="-1"></a>      <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb130-181"><a href="function-approximation-and-feature-engineering.html#cb130-181" tabindex="-1"></a>      <span class="fu">theme</span>(</span>
<span id="cb130-182"><a href="function-approximation-and-feature-engineering.html#cb130-182" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb130-183"><a href="function-approximation-and-feature-engineering.html#cb130-183" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb130-184"><a href="function-approximation-and-feature-engineering.html#cb130-184" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey90&quot;</span>, <span class="at">color =</span> <span class="cn">NA</span>),</span>
<span id="cb130-185"><a href="function-approximation-and-feature-engineering.html#cb130-185" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb130-186"><a href="function-approximation-and-feature-engineering.html#cb130-186" tabindex="-1"></a>      )</span>
<span id="cb130-187"><a href="function-approximation-and-feature-engineering.html#cb130-187" tabindex="-1"></a>    </span>
<span id="cb130-188"><a href="function-approximation-and-feature-engineering.html#cb130-188" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb130-189"><a href="function-approximation-and-feature-engineering.html#cb130-189" tabindex="-1"></a>  }</span>
<span id="cb130-190"><a href="function-approximation-and-feature-engineering.html#cb130-190" tabindex="-1"></a>  </span>
<span id="cb130-191"><a href="function-approximation-and-feature-engineering.html#cb130-191" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb130-192"><a href="function-approximation-and-feature-engineering.html#cb130-192" tabindex="-1"></a>    <span class="at">encode =</span> encode,</span>
<span id="cb130-193"><a href="function-approximation-and-feature-engineering.html#cb130-193" tabindex="-1"></a>    <span class="at">visualize_activation_landscape =</span> visualize_activation_landscape,</span>
<span id="cb130-194"><a href="function-approximation-and-feature-engineering.html#cb130-194" tabindex="-1"></a>    <span class="at">visualize_individual_rbfs =</span> visualize_individual_rbfs,</span>
<span id="cb130-195"><a href="function-approximation-and-feature-engineering.html#cb130-195" tabindex="-1"></a>    <span class="at">centers =</span> centers,</span>
<span id="cb130-196"><a href="function-approximation-and-feature-engineering.html#cb130-196" tabindex="-1"></a>    <span class="at">widths =</span> widths,</span>
<span id="cb130-197"><a href="function-approximation-and-feature-engineering.html#cb130-197" tabindex="-1"></a>    <span class="at">n_rbf =</span> n_rbf,</span>
<span id="cb130-198"><a href="function-approximation-and-feature-engineering.html#cb130-198" tabindex="-1"></a>    <span class="at">create_adaptive_centers =</span> create_adaptive_centers</span>
<span id="cb130-199"><a href="function-approximation-and-feature-engineering.html#cb130-199" tabindex="-1"></a>  ))</span>
<span id="cb130-200"><a href="function-approximation-and-feature-engineering.html#cb130-200" tabindex="-1"></a>}</span>
<span id="cb130-201"><a href="function-approximation-and-feature-engineering.html#cb130-201" tabindex="-1"></a></span>
<span id="cb130-202"><a href="function-approximation-and-feature-engineering.html#cb130-202" tabindex="-1"></a><span class="co"># Example usage with adaptive center placement</span></span>
<span id="cb130-203"><a href="function-approximation-and-feature-engineering.html#cb130-203" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb130-204"><a href="function-approximation-and-feature-engineering.html#cb130-204" tabindex="-1"></a></span>
<span id="cb130-205"><a href="function-approximation-and-feature-engineering.html#cb130-205" tabindex="-1"></a><span class="co"># Create RBF centers using k-means-like clustering</span></span>
<span id="cb130-206"><a href="function-approximation-and-feature-engineering.html#cb130-206" tabindex="-1"></a>rbf_net_temp <span class="ot">&lt;-</span> <span class="fu">create_rbf_network</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">1</span>), <span class="fl">1.0</span>)</span>
<span id="cb130-207"><a href="function-approximation-and-feature-engineering.html#cb130-207" tabindex="-1"></a>rbf_centers <span class="ot">&lt;-</span> rbf_net_temp<span class="sc">$</span><span class="fu">create_adaptive_centers</span>(</span>
<span id="cb130-208"><a href="function-approximation-and-feature-engineering.html#cb130-208" tabindex="-1"></a>  <span class="at">state_dims =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), </span>
<span id="cb130-209"><a href="function-approximation-and-feature-engineering.html#cb130-209" tabindex="-1"></a>  <span class="at">n_centers =</span> <span class="dv">12</span></span>
<span id="cb130-210"><a href="function-approximation-and-feature-engineering.html#cb130-210" tabindex="-1"></a>)</span>
<span id="cb130-211"><a href="function-approximation-and-feature-engineering.html#cb130-211" tabindex="-1"></a></span>
<span id="cb130-212"><a href="function-approximation-and-feature-engineering.html#cb130-212" tabindex="-1"></a><span class="co"># Create RBF network with adaptive centers</span></span>
<span id="cb130-213"><a href="function-approximation-and-feature-engineering.html#cb130-213" tabindex="-1"></a>rbf_network <span class="ot">&lt;-</span> <span class="fu">create_rbf_network</span>(</span>
<span id="cb130-214"><a href="function-approximation-and-feature-engineering.html#cb130-214" tabindex="-1"></a>  <span class="at">centers =</span> rbf_centers, </span>
<span id="cb130-215"><a href="function-approximation-and-feature-engineering.html#cb130-215" tabindex="-1"></a>  <span class="at">widths =</span> <span class="fl">1.5</span>  <span class="co"># Uniform width for all RBFs</span></span>
<span id="cb130-216"><a href="function-approximation-and-feature-engineering.html#cb130-216" tabindex="-1"></a>)</span>
<span id="cb130-217"><a href="function-approximation-and-feature-engineering.html#cb130-217" tabindex="-1"></a></span>
<span id="cb130-218"><a href="function-approximation-and-feature-engineering.html#cb130-218" tabindex="-1"></a><span class="co"># Visualize activation landscape</span></span>
<span id="cb130-219"><a href="function-approximation-and-feature-engineering.html#cb130-219" tabindex="-1"></a><span class="fu">print</span>(rbf_network<span class="sc">$</span><span class="fu">visualize_activation_landscape</span>(<span class="at">state_dims =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>)))</span></code></pre></div>
<pre><code>## Warning: The following aesthetics were dropped during statistical transformation: fill.
## â¹ This can happen when ggplot fails to infer the correct grouping structure in the data.
## â¹ Did you forget to specify a `group` aesthetic or to convert a numerical variable into a factor?</code></pre>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="function-approximation-and-feature-engineering.html#cb132-1" tabindex="-1"></a><span class="co"># Visualize individual RBFs</span></span>
<span id="cb132-2"><a href="function-approximation-and-feature-engineering.html#cb132-2" tabindex="-1"></a><span class="fu">print</span>(rbf_network<span class="sc">$</span><span class="fu">visualize_individual_rbfs</span>(<span class="at">state_dims =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">10</span>)))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-39-2.png" width="672" /></p>
</div>
</div>
<div id="comparative-analysis-and-practical-considerations" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Comparative Analysis and Practical Considerations<a href="function-approximation-and-feature-engineering.html#comparative-analysis-and-practical-considerations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The choice between different basis function methods involves tradeoffs across multiple dimensions that depend on the specific requirements of the learning problem. Computational efficiency varies significantly between approaches. Tile coding typically offers the best computational performance because it requires only simple arithmetic operations and guarantees a fixed, small number of active features per state. This predictable activation pattern makes memory access patterns efficient and simplifies the implementation of learning algorithms.</p>
<p>Coarse coding can be computationally expensive when implemented naively, requiring distance calculations to all receptive field centers. However, efficient implementations using spatial data structures can dramatically reduce this cost. RBF networks generally require the most computation since they must evaluate all basis functions for every state, though this cost can be acceptable for problems with moderate numbers of basis functions.</p>
<p>Memory requirements also differ substantially. Tile coding with N tilings and T tiles per tiling requires NÃT features, but the sparse activation pattern means that storage can be optimized. RBF networks must store all centers and widths explicitly, and the dense activation patterns require more memory during computation.</p>
<p>The control over generalization represents perhaps the most important distinction between methods. RBF networks provide the finest-grained control through careful placement of centers and tuning of widths. This flexibility makes them particularly suitable for problems where the optimal policy varies smoothly across the state space. Tile coding offers structured, axis-aligned generalization that can be controlled through the number and arrangement of tilings. This asymmetric generalization often matches the structure of control problems where different state dimensions have different physical meanings and scaling properties.</p>
<p>Coarse coding provides the most intuitive approach to generalization control but offers less precise tuning than the alternatives. The circular or spherical regions create symmetric generalization that may not align well with the natural structure of some problems.</p>
</div>
<div id="bridging-classical-and-modern-approaches" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Bridging Classical and Modern Approaches<a href="function-approximation-and-feature-engineering.html#bridging-classical-and-modern-approaches" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>These classical basis function methods are not mere historical artifacts but continue to play important roles in modern RL systems. They provide interpretable building blocks that can be combined with neural networks to create hybrid architectures. For instance, RBF networks can serve as the final layer of a deep network, providing smooth interpolation over a learned feature space. Tile coding remains competitive for many control problems, particularly those with moderate dimensionality where its computational advantages outweigh the representational limitations.</p>
<p>Perhaps most importantly, these methods provide the conceptual foundation for understanding deep RL. The discrimination-generalization tradeoff that appears explicitly in classical function approximation operates implicitly in neural networks. The stability issues that arise in linear TD learning become even more complex in the nonlinear setting but follow similar patterns. The feature engineering principles that guide classical basis function design inform the architecture choices and training procedures used in deep networks.</p>
<p>Understanding how to balance computational efficiency, representational power, and generalization control in classical methods provides invaluable intuition for navigating the much larger design space of modern deep RL systems. The journey from tabular methods to neural networks necessarily passes through this classical territory, making these concepts essential knowledge for any serious RL practitioner.</p>
<p>The mathematical principles, design tradeoffs, and practical considerations explored in this appendix provide a solid foundation for understanding both current RL systems and future developments in the field. As the field continues to evolve, these fundamental concepts remain relevant, offering both practical tools for appropriate problems and conceptual frameworks for understanding more sophisticated approaches.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dyna-q-enhanced-exploration-in-integrated-learning-and-planning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="learning-policies-versus-learning-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/Kamran-Afzali/Bookdown_RLR/edit/main/11-Functions_Features.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Kamran-Afzali/Bookdown_RLR/blob/main/11-Functions_Features.Rmd",
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
